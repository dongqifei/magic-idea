import{b as Me,E as Te,D as fe,e as Ae,a as Ke}from"./monaco-model-service-Dr7hbA1E.js";import{x as je,e as v,K as ge,Y as y,Z as ve,T as we,_ as T,$ as _,a0 as qe}from"./index-Oj7xzQpQ.js";class We extends Me{constructor(e,t,s,n){super(e,t,s,n),this.addClass("monaco-editor-widget")}get editorType(){return Te.DEFAULT}getLabelPrefix(){return""}getValue(){return this.model?.getValue()??""}doLayout(){try{this._editor?.layout?.()}catch{}}disposeEditor(){try{this._editor?.dispose()}catch{}finally{this._editor=null,this._model=null}}focus(){try{this._editor?.focus?.()}catch{}}}var $e=Object.getOwnPropertyDescriptor,Xe=(r,e,t,s)=>{for(var n=s>1?void 0:s?$e(e,t):e,a=r.length-1,l;a>=0;a--)(l=r[a])&&(n=l(n)||n);return n},$=(r,e)=>(t,s)=>e(t,s,r);let z=class{constructor(r,e,t){this.preferenceService=r,this.modelService=e,this.themeService=t}id="monaco";label="Monaco";disposables=new je;async createEditor(r,e){const t=this.modelService.pinModel(r,{script:e?.script,language:e?.language}),s=document.createElement("div");s.style.width="100%",s.style.height="calc(100% - 4px)",s.className="monaco-editor-container";let n={...e?.editorOptions};const a=this.preferenceService.getAllKeys();for(const u of a){const E=this.setOption(u,this.preferenceService.get(u),this.preferencePrefixes);n=Object.assign(n,E)}const l=await this.themeService.getCurrentTheme();n={...n,theme:l?.id??"vs"};const o=v.create(s,{model:t??void 0,glyphMargin:!0,minimap:{enabled:!0},lineDecorationsWidth:20,overviewRulerLanes:3,lineNumbersMinChars:3,automaticLayout:!1,...n||{}});this.preferenceService.onDidPreferenceChanged(u=>{this.updateMonacoEditorOptions(o,u)});const c=new We(r,e,o,t),h=this.themeService.onDidChangeTheme(u=>{!c.isDisposed&&u.newTheme&&c.editor.updateOptions({theme:u.newTheme.id})});return this.disposables.push(h),c.node.appendChild(s),c}score(r){return 10}dispose(r){try{this.modelService.releaseModel(r)}catch(e){console.error(e)}this.disposables.dispose()}get preferencePrefixes(){return["editor."]}setOption(r,e,t,s={}){const n=this.toOptionName(r,t);return n===void 0||this.doSetOption(s,e,n.split(".")),s}toOptionName(r,e){for(const t of e)if(r.startsWith(t))return r.substring(t.length)}doSetOption(r,e,t){for(let s=0;s<t.length-1;s++){const n=t[s];r[n]===void 0?r=r[n]={}:typeof r[n]!="object"||r[n]===null?(console.warn(`Preference (diff)editor.${t.join(".")} conflicts with another preference name.`),r=r[n]={}):r=r[n]}r[t[t.length-1]]=e}updateMonacoEditorOptions(r,e){if(e){const t=e.key,s=this.preferenceService.get(t),n=this.setOption(t,s,this.preferencePrefixes);r.updateOptions(n)}}};z=Xe([ge(),$(0,y(ve)),$(1,y(fe)),$(2,y(we))],z);class Je extends Me{originalResourcePath;modifiedResourcePath;constructor(e,t,s,n,a,l){super(e,t,s,n),this.originalResourcePath=a,this.modifiedResourcePath=l}getOriginalResourcePath(){return this.originalResourcePath}getModifiedResourcePath(){return this.modifiedResourcePath}get editorType(){return Te.DIFFE_EDITOR}getLabelPrefix(){return"Diff:"}getValue(){return this.model?.getValue()??""}doLayout(){try{this._editor?.layout?.()}catch{}}disposeEditor(){try{this._editor?.dispose()}catch{}finally{this._editor=null,this._model=null}}focus(){try{this._editor?.focus?.()}catch{}}}var Qe=Object.getOwnPropertyDescriptor,Ze=(r,e,t,s)=>{for(var n=s>1?void 0:s?Qe(e,t):e,a=r.length-1,l;a>=0;a--)(l=r[a])&&(n=l(n)||n);return n},X=(r,e)=>(t,s)=>e(t,s,r);let ee=class{constructor(r,e,t){this.preferenceService=r,this.modelService=e,this.themeService=t}id="monaco-diff";label="Monaco Diff Editor";createEditor(r,e){const{originalResourcePath:t,modifiedResourcePath:s,originalContent:n,modifiedContent:a,language:l}=e||{};if(!t||!s)throw new Error("Diff editor requires originalResourcePath and modifiedResourcePath");const o=this.modelService.pinModel(t,{script:n,language:l}),c=this.modelService.pinModel(s,{script:a,language:l}),h=document.createElement("div");h.style.width="100%",h.style.height="calc(100% - 4px)",h.className="monaco-diff-editor-container";const u=v.createDiffEditor(h,{fontSize:14,glyphMargin:!0,minimap:{enabled:!0},theme:"vs",lineNumbers:"on",automaticLayout:!0,readOnly:!0,renderSideBySide:!0,...e?.editorOptions||{}});u.setModel({original:o,modified:c});const E=new Je(r,e,u,c,t,s);return E.node.appendChild(h),E}score(r,e){if(e?.isDiff||e?.originalResourcePath&&e?.modifiedResourcePath){const t=r.split(".").pop()?.toLowerCase();return t&&["ts","js","jsx","tsx","java","py","go","rs"].includes(t)?200:150}return 0}};ee=Ze([ge(),X(0,y(ve)),X(1,y(fe)),X(2,y(we))],ee);var ze=Object.getOwnPropertyDescriptor,et=(r,e,t,s)=>{for(var n=s>1?void 0:s?ze(e,t):e,a=r.length-1,l;a>=0;a--)(l=r[a])&&(n=l(n)||n);return n};let te=class{matches(r){return r.editorType===Te.DIFFE_EDITOR}getResourceInfo(r){const e=r,t=e.getOriginalResourcePath(),s=e.getModifiedResourcePath();return{resourceUri:e.resourceUri,metadata:{originalResourcePath:t,modifiedResourcePath:s}}}getSplitOptions(r){const e=r;return{isDiff:!0,originalResourcePath:e.getOriginalResourcePath(),modifiedResourcePath:e.getModifiedResourcePath()}}};te=et([ge()],te);const re={builtinFunctions:[],operators:["+","-","*","/","=","==","!=",">","<",">=","<="],symbols:/[=><!~?:&|+\-*/^%]+/,digits:/\d+(_+\d+)*/,binarydigits:/[0-1_]+/,hexdigits:/[[0-9a-fA-F_]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,types:["var","const","let","Object","Long","String","Double","Float","Integer","Byte","Pattern","BigDecimal","Boolean"],keywords:["import","as","return","exit","try","catch","finally","throw","if","else","switch","case","default","for","while","do","continue","break","null","true","false"],regexpctl:/[(){}\[\]\$\^|\-*+?\.]/,regexpesc:/\\(?:[bBdDfnrstvwWn0\\\/]|@regexpctl|c[A-Z]|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})/,tokenizer:{root:[[/\.[a-zA-Z_]\w*(?=\()/,"function"],[/(@digits)/,"number"],[/\s+/,"white"],[/```$/,{token:"string",next:"@codeblock"}],[/[a-zA-Z_$][\w$]*/,{cases:{"@builtinFunctions":"sys.function","@types":"keyword","@keywords":"sys.keyword","~(instanceof|new|in|async|asc|desc|ASC|DESC|assert|select|from|left|join|on|and|or|order|by|where|group|having|limit|)[\\s]?":{token:"keyword"},"~(select|from|left|join|on|and|or|order|by|where|group|having|limit|offset|SELECT|FROM|LEFT|JOIN|ON|AND|OR|ORDER|BY|WHERE|GROUP|HAVING|LIMIT|OFFSET)[\\s]{1}":{token:"keywords"},"@default":"identifier"}}],[/"""/,{token:"string",next:"@string_multi_embedded",nextEmbedded:"mybatis"}],[/::[a-zA-Z]+/,"keyword"],[/[;,.]/,"delimiter"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/"/,"string","@string_double"],[/'/,"string","@string_single"],[/\/\/.*$/,"comment"],[/\/\*/,"comment","@comment"],[/\/(?=([^\\\/]|\\.)+\/([gimsuy]*)(\s*)(\.|;|,|\)|\]|\}|$))/,{token:"regexp",bracket:"@open",next:"@regexp"}],[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/"/,"string","@string_double"],[/'/,"string","@string_single"],[/`/,"string","@string_backtick"],[/@symbols/,"operator"]],comment:[[/\*\//,"comment","@pop"],[/[^/*]+/,"comment"],[/[/\*]/,"comment"]],codeblock:[[/^```$/,{token:"string",next:"@pop"}],[/.*$/,"variable.source"]],regexp:[[/(\{)(\d+(?:,\d*)?)(\})/,["regexp.escape.control","regexp.escape.control","regexp.escape.control"]],[/(\[)(\^?)(?=(?:[^\]\\\/]|\\.)+)/,["regexp.escape.control",{token:"regexp.escape.control",next:"@regexrange"}]],[/(\()(\?:|\?=|\?!)/,["regexp.escape.control","regexp.escape.control"]],[/[()]/,"regexp.escape.control"],[/@regexpctl/,"regexp.escape.control"],[/[^\\\/]/,"regexp"],[/@regexpesc/,"regexp.escape"],[/\\\./,"regexp.invalid"],[/(\/)([gimsuy]*)/,[{token:"regexp",bracket:"@close",next:"@pop"},"keyword.other"]]],regexrange:[[/-/,"regexp.escape.control"],[/\^/,"regexp.invalid"],[/@regexpesc/,"regexp.escape"],[/[^\]]/,"regexp"],[/\]/,{token:"regexp.escape.control",next:"@pop",bracket:"@close"}]],string_multi_embedded:[[/[^"]+/,""],['"""',{token:"string",next:"@pop",nextEmbedded:"@pop"}]],string_double:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],string_single:[[/[^\\']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/'/,"string","@pop"]],string_backtick:[[/\$\{/,{token:"delimiter.bracket",next:"@bracketCounting"}],[/[^\\`$]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/`/,"string","@pop"]],bracketCounting:[[/\{/,"delimiter.bracket","@bracketCounting"],[/\}/,"delimiter.bracket","@pop"],{include:"root"}]}};let D={},Se={},Y=[],se=[],V,ne;const ie={config:{}};let j;const tt=r=>{j=r},rt=r=>{ie.config=r},st=r=>r==="int"||r==="java.lang.Integer"?"java.lang.Integer":r==="string"||r==="java.lang.String"?"java.lang.String":r==="double"||r==="java.lang.Double"?"java.lang.Double":r==="float"||r==="java.lang.Float"?"java.lang.Float":r==="byte"||r==="java.lang.Byte"?"java.lang.Byte":r==="short"||r==="java.lang.Short"?"java.lang.Short":r==="long"||r==="java.lang.Long"?"java.lang.Long":r.indexOf("[]")>-1?"[Ljava.lang.Object;":r||"java.lang.Object",ae=r=>{let e=r.lastIndexOf(".");return e>-1?r.substring(e+1):r},nt=(r,e,t)=>r.length>0&&r[r.length-1].varArgs?t?r.length-1<=e.length:r.length<=e.length:t?r.length-1===e.length:r.length===e.length,it=async function(){const r=await j.getClasses();return new Promise((e,t)=>{const{data:s}=r;D=s.classes||{},Se=s.extensions||{},se=s.functions||[],re.builtinFunctions=se.map(n=>n.name),T.setMonarchTokensProvider("magicscript",re)})},at=async()=>{const r=await j.getClassesText();return new Promise((e,t)=>{const s=[];r.split(`
`).forEach(n=>{const a=n.split(":");a.length===1?s.push(a[0]):s.push(...a[1].split(",").map(l=>a[0]+"."+l))}),Y=s}).catch(e=>{console.log(e)})},me=(r,e)=>Array(e>(r+"").length?e-(""+r).length-1:0).join(0)+r,ye=r=>{let e=[];return r&&(e=r.enums||[],r.superClass&&(e=e.concat(ye(r.superClass)))),e},Ue=(r,e,t)=>{if(r.insertText=r.name,r.parameters.length>e){let s=[],n=[];for(let a=e;a<r.parameters.length;a++)s.push("${"+(a+1-e)+":"+r.parameters[a].name+"}"),r.parameters[a].varArgs?n.push(ae(r.parameters[a].type).replace("[]","")+" ... "+r.parameters[a].name):n.push(ae(r.parameters[a].type)+" "+r.parameters[a].name);r.sortText=me(t,10)+r.name,r.fullName=r.name+"("+n.join(", ")+")",r.insertText+="("+s.join(",")+")",r.signature=r.name+n.join(",")}else r.sortText=me(t,10)+r.name,r.insertText+="()",r.fullName=r.name+"()",r.signature=r.name;return r};let le={};const lt=(r,e)=>{le[r]=e},oe=r=>{let e=[];if(r){if(e=r.attributes||[],r.superClass&&(e=e.concat(oe(r.superClass))),r.interfaces&&r.interfaces.length>0)for(let t=0,s=r.interfaces.length;t<s;t++)e=e.concat(oe(r.interfaces[t]));le[r.className]&&(e=e.concat(le[r.className]))}return e},ce=(r,e)=>{e=e||0;let t=[],s=(n,a,l)=>{if(n&&n.methods)for(let o=0,c=n.methods.length;o<c;o++){let h=n.methods[o];h=Ue(h,a,l),h.extension=a===1,t.push(h)}};if(typeof r=="string"&&(r=D[r]),r){if(s(r,0,e),r.superClass&&(t=t.concat(ce(r.superClass,e+1))),r.interfaces&&r.interfaces.length>0)for(let n=0,a=r.interfaces.length;n<a;n++)t=t.concat(ce(r.interfaces[n],e+100));r=Se[r.className],r&&s(r,1,e+1e4)}return t},ot=r=>Se[r],ct=r=>{if(!r)throw new Error("className is required");let e=D[r];if(!e){let t=Y.findIndex(s=>s===r);e=Y[t]}return e};async function ht(r){let e=D[r];if(e)e=D[e.className]||e;else try{(await j.getClass({className:r})).data.forEach(n=>{D[n.className]=n}),e=D[r]}catch(t){console.log(t)}return e}const Et=()=>se.map(r=>Ue(r,0,1)),be=()=>{if(!V&&ie.config){let r=ie.config;r.autoImportModuleList&&(V={},r.autoImportModuleList.forEach(t=>{V[t]=t}));let e=["java.util.","java.lang."].concat((r.autoImportPackage||"").replace(/\\s/g,"").replace(/\*/g,"").split(","));ne={},Y.forEach(t=>{e.forEach(s=>{t.indexOf(s)===0&&t.indexOf(".",s.length)===-1&&(ne[t.substring(t.lastIndexOf(".")+1)]=t)})})}},ut=()=>(be(),V||{}),pt=()=>(be(),ne||{}),Tt=()=>Y;let he;const ft=r=>{he=r},gt=r=>he&&he(r),St=()=>Object.keys(D).filter(r=>D[r].module);let Fe;const dt=r=>{Fe=r};let Be;const At=r=>{Be=r},mt=()=>Fe,Rt=()=>Be,d={findEnums:ye,findAttributes:oe,findMethods:ce,findFunction:Et,loadClass:ht,findClass:ct,initMagicApiClient:tt,initContants:rt,initClasses:it,initImportClass:at,getWrapperClass:st,matchTypes:nt,getAutoImportModule:ut,getAutoImportClass:pt,getExtension:ot,getImportClass:Tt,getOnlineFunction:gt,setupOnlineFunction:ft,setExtensionAttribute:lt,getSimpleClass:ae,getDefineModules:St,setApiFinder:dt,setFunctionFinder:At,getApiFinder:mt,getFunctionFinder:Rt};class R extends Error{constructor(e,t){super(e),this.name="ParseException",this.span=t}}class It{constructor(e,t,s,n,a,l,o){this.source=e,this.start=t,this.end=s,this.lineNumber=n,this.endLineNumber=a,this.startCol=l,this.endCol=o}}class g{source;start;end;cachedText;line;constructor(e,t,s){e instanceof g&&t instanceof g?(this.source=e.source,this.start=e.start,this.end=t.end,this.cachedText=this.source.substring(this.start,this.end)):(this.source=e,this.start=t||0,this.end=s||e.length,this.cachedText=e.substring(this.start,this.end))}getText(){return this.cachedText}getSource(){return this.source}getStart(){return this.start}getEnd(){return this.end}toString(){return"Span [text="+this.getText()+", start="+this.start+", end="+this.end+"]"}inPosition(e){return this.start<=e&&this.end>=e}getLine(){if(this.line!=null)return this.line;let e=this.start;for(;e<this.end&&!(e<0);){if(this.source.charAt(e)===`
`){e=e+1;break}e--}e<0&&(e=0);let t=this.end;for(;!(t>this.source.length-1||this.source.charAt(t)===`
`);)t++;let s=0,n=e;for(;n>0&&n<this.end;)this.source.charAt(n)===`
`&&s++,n--;s++,n=e+1;let a=s;for(;n<t;)this.source.charAt(n)===`
`&&a++,n++;let l=this.start-e+1,o=l+this.end-this.start-1;return this.line=new It(this.source,e,t,s,a,l,o),this.line}}const i={Spread:{literal:"...",error:"..."},Period:{literal:".",error:"."},QuestionPeriod:{literal:"?.",error:"?."},Comma:{literal:",",error:","},Semicolon:{literal:";",error:";"},Colon:{literal:":",error:":"},Plus:{literal:"+",error:"+"},Minus:{literal:"-",error:"-"},Asterisk:{literal:"*",error:"*"},ForwardSlash:{literal:"/",error:"/"},PostSlash:{literal:"\\",error:"\\"},Percentage:{literal:"%",error:"%"},LeftParantheses:{literal:"(",error:"("},RightParantheses:{literal:")",error:")"},LeftBracket:{literal:"[",error:"["},RightBracket:{literal:"]",error:"]"},LeftCurly:{literal:"{",error:"{"},RightCurly:{error:"}"},Less:{literal:"<",error:"<"},Greater:{literal:">",error:">"},LessEqual:{literal:"<=",error:"<="},GreaterEqual:{literal:">=",error:">="},Equal:{literal:"==",error:"=="},NotEqual:{literal:"!=",error:"!="},Assignment:{literal:"=",error:"="},PlusPlus:{literal:"++",error:"++"},MinusMinus:{literal:"--",error:"--"},PlusEqual:{literal:"+=",error:"+="},MinusEqual:{literal:"-=",error:"-="},AsteriskEqual:{literal:"*=",error:"*="},ForwardSlashEqual:{literal:"/=",error:"/="},PercentEqual:{literal:"%=",error:"%="},ColonColon:{literal:"::",error:"::"},EqualEqualEqual:{literal:"===",error:"==="},NotEqualEqual:{literal:"!==",error:"!=="},And:{literal:"&&",error:"&&"},Or:{literal:"||",error:"||"},Xor:{literal:"^",error:"^"},Not:{literal:"!",error:"!"},BitAnd:{literal:"&",error:"&"},BitOr:{literal:"|",error:"|"},BitNot:{literal:"~",error:"~"},LShift:{literal:"<<",error:"<<"},RShift:{literal:">>",error:">>"},RShift2:{literal:">>>",error:">>>"},XorEqual:{literal:"^=",error:"^=",modifiable:!0},BitAndEqual:{literal:"&=",error:"&=",modifiable:!0},BitOrEqual:{literal:"|=",error:"|=",modifiable:!0},LShiftEqual:{literal:"<<=",error:"<<=",modifiable:!0},RShiftEqual:{literal:">>=",error:">>=",modifiable:!0},RShift2Equal:{literal:">>>=",error:">>>=",modifiable:!0},SqlAnd:{literal:"and",error:"and"},SqlOr:{literal:"or",error:"or"},SqlNotEqual:{literal:"<>",error:"<>",inLinq:!0},InstanceOf:{literal:"instanceof",error:"instanceof"},Questionmark:{literal:"?",error:"?"},DoubleQuote:{literal:'"',error:'"'},TripleQuote:{literal:'"""',error:'"""'},SingleQuote:{literal:"'",error:"'"},Lambda:{error:"=> 或 ->"},BooleanLiteral:{error:"true 或 false"},DoubleLiteral:{error:"一个 double 类型数值"},DecimalLiteral:{error:"一个 BigDecimal 类型数值"},FloatLiteral:{error:"一个 float 类型数值"},LongLiteral:{error:"一个 long 类型数值"},IntegerLiteral:{error:"一个 int 类型数值"},ShortLiteral:{error:"一个 short 类型数值"},ByteLiteral:{error:"一个 byte 类型数据"},CharacterLiteral:{error:"一个 char 类型数据"},RegexpLiteral:{error:"一个 正则表达式"},StringLiteral:{error:"一个 字符串"},NullLiteral:{error:"null"},Language:{error:"language"},Identifier:{error:"标识符"},Unknown:{error:"unknown"}};let Ot=Object.getOwnPropertyNames(i).map(r=>i[r]);i.getSortedValues=function(){return this.values?this.values:(this.values=Ot.sort(function(r,e){return!r.literal&&!e.literal?0:!r.literal&&e.literal?1:r.literal&&!e.literal?-1:e.literal.length-r.literal.length}),this.values)};class C{constructor(e,t,s){this.type=e,this.span=t,s instanceof U?this.tokenStream=s:s&&(this.value=s)}getTokenType(){return this.type}getTokenStream(){return this.tokenStream}getSpan(){return this.span}getText(){return this.span.getText()}}class L extends C{constructor(e,t,s){super(e,t,s)}getJavaType(){return this.type===i.StringLiteral?"java.lang.String":this.type===i.DoubleLiteral?"java.lang.Double":this.type===i.ByteLiteral?"java.lang.Byte":this.type===i.FloatLiteral?"java.lang.Float":this.type===i.DecimalLiteral?"java.math.BigDecimal":this.type===i.IntegerLiteral?"java.lang.Integer":this.type===i.LongLiteral?"java.lang.Long":this.type===i.BooleanLiteral?"java.lang.Boolean":this.type===i.RegexpLiteral?"java.util.regex.Pattern":"java.lang.Object"}}class Nt{constructor(e,t,s){this.index=t===void 0?0:t,this.end=s===void 0?e.length:s,this.source=e,this.spanStart=0}hasMore(){return this.index<this.end}consume(){return this.source.charAt(this.index++)}match(e,t){typeof e!="string"&&(e=e.literal);let s=e.length;if(s+this.index>this.end)return!1;for(let n=0,a=this.index;n<s;n++,a++)if(this.index>=this.end||e.charAt(n)!==this.source.charAt(a))return!1;return t&&(this.index+=s),!0}matchAny(e,t){for(let s=0,n=e.length;s<n;s++)if(this.match(e[s],t))return!0;return!1}matchDigit(e){return this.matchAny("0123456789",e)}matchIdentifierStart(e){if(this.index>=this.end)return!1;let t=this.source.charAt(this.index);return t.match(/[a-zA-Z0-9_\u4e00-\u9fa5]/)||t==="$"||t==="_"||t==="@"?(e&&this.index++,!0):!1}matchIdentifierPart(e){if(this.index>=this.end)return!1;let t=this.source.charAt(this.index);return t.match(/[a-zA-Z0-9_\u4e00-\u9fa5]/)||t==="@"?(e&&this.index++,!0):!1}skipWhiteSpace(){for(;this.index<this.end;){let e=this.source.charAt(this.index);if(e===" "||e===`
`||e==="\r"||e==="	")this.index++;else break}}getSpan(e,t){return new g(this.source,e,t)}skipLine(){for(;this.index<this.end&&this.source.charAt(this.index++)!==`
`;);}skipUntil(e){for(;this.index<this.end;){let t=!0;for(let s=0,n=e.length;s<n&&this.index+s<this.end;s++)if(e.charAt(s)!==this.source.charAt(this.index+s)){t=!1;break}if(this.index+=t?e.length:1,t)return!0}return!1}startSpan(){this.spanStart=this.index}endSpan(e,t){return t!==void 0?new g(this.source,e,t):new g(this.source,this.spanStart,this.index+(e||0))}getPosition(){return this.index}reset(e){this.index=e}}class U{constructor(e){this.tokens=e,this.index=0,this.end=e.length}getEnd(){return this.end>0&&this.tokens[this.end-1]}hasMore(){return this.index<this.end}hasNext(){return this.index+1<this.end}makeIndex(){return this.index}resetIndex(e){this.index=e}getToken(e){let t=this.tokens[this.index];return e&&this.index++,t}consume(){if(!this.hasMore())throw new Error("Reached the end of the source.");return this.tokens[this.index++]}next(){if(!this.hasMore())throw new Error("Reached the end of the source.");return this.tokens[++this.index]}prev(){if(this.index===0)throw new Error("Reached the end of the source.");return this.tokens[--this.index]}getPrev(){if(this.index===0)throw new Error("Reached the end of the source.");return this.tokens[this.index-1]}match(e,t,s){if(this.index>=this.end)return!1;let n=!1;if(Array.isArray(e)){for(let a=0,l=e.length;a<l;a++)if(this.match(e[a],t,s))return!0}else typeof e=="string"?(this.tokens[this.index].getText()===e||s===!0&&this.tokens[this.index].getText().toLowerCase()===e.toLowerCase())&&(n=!0):this.tokens[this.index].type===e&&(n=!0);return n&&t&&this.index++,n}textToString(e){if(typeof e=="string")return e;if(e instanceof C)return e.getText();if(Array.isArray(e)){let t=[];return e.forEach(s=>t.push(this.textToString(s))),t.join(",")}else return e.error}expect(e,t){if(this.match(e,!0,t))return this.tokens[this.index-1];if(this.hasMore()){let s=this.tokens[this.index];throw e instanceof C&&(e=e.type.error),new R("Expected '"+this.textToString(e)+"', but got '"+s.getText()+"'",s.getSpan())}else{let s=this.tokens[this.index-1].getSpan();return new C(i.Unknown,s)}}hasPrev(){return this.index>0}getSource(){return this.tokens.length===0?null:this.tokens[0].getSpan().getSource()}}const Lt=(r,e)=>{if(e.length>0){let t=e[e.length-1];if(t instanceof L)return!1;switch(t.getTokenType()){case i.Comma:case i.Semicolon:case i.Colon:case i.RightCurly:case i.LeftBracket:case i.LeftParantheses:case i.Assignment:case i.NotEqual:case i.EqualEqualEqual:case i.NotEqualEqual:case i.Equal:case i.And:case i.Or:case i.SqlAnd:case i.SqlOr:case i.SqlNotEqual:case i.Questionmark:case i.InstanceOf:case i.Lambda:case i.Not:break;default:return!1}}if(r.match("/",!1)){let t=r.getPosition();r.consume(),r.startSpan();let s=!1,n=0,a=0,l=0;for(;r.hasMore();){if(r.match("\\",!0)){r.consume();continue}if(r.match("[",!1))n++,a=r.getPosition();else if(n>0&&r.match("]",!1))n--;else if(r.match(i.ForwardSlash.literal,!0))if(n===0){r.match("g",!0),r.match("i",!0),r.match("m",!0),r.match("s",!0),r.match("u",!0),r.match("y",!0),s=!0;break}else l=r.getPosition();let c=r.consume();if(c==="\r"||c===`
`)return r.reset(t),!1}if(n!==0)throw new R("Missing ']'",r.getSpan(a,l-1));if(!s)return r.reset(t),!1;let o=r.endSpan();return o=r.getSpan(o.getStart()-1,o.getEnd()),e.push(new L(i.RegexpLiteral,o,null)),!0}return!1},J=(r,e,t)=>{if(r.match(e,!0)){r.startSpan();let s=!1;for(;r.hasMore();){if(r.match("\\",!0)){r.consume();continue}if(r.match(e.literal,!0)){s=!0;break}let a=r.consume();if(e!==i.TripleQuote&&(a==="\r"||a===`
`))throw new R(`${e.error}${e.error}定义的字符串不能换行`,r.endSpan())}if(!s)throw new R(`字符串没有结束符${e.error}`,r.endSpan());let n=r.endSpan();return n=r.getSpan(n.getStart(),n.getEnd()-e.literal.length),t.push(new L(i.StringLiteral,n,null)),!0}return!1},Re=(r,e)=>{let t=Number.parseInt(r.getText().substring(2).replace(/\_/g,""),e);return t>2147483647||t<-2147483648?new L(i.LongLiteral,r,t):t>127||t<-128?new L(i.IntegerLiteral,r,t):new L(i.ByteLiteral,r,t)},Ct=(r,e)=>{if(r.match("0",!1)){let t=r.getPosition();if(r.startSpan(),r.consume(),r.matchAny(["x","X"],!0)){for(;r.matchDigit(!0)||r.matchAny(["A","B","C","D","E","F","a","b","c","d","e","f","_"],!0););if(r.matchAny(["L","l"],!0)){let s=r.endSpan(),n=s.getText();return e.push(new L(i.LongLiteral,s,parseInt(n.substring(2,n.length-1).replace(/\_/g,""),16))),!0}return e.push(Re(r.endSpan(),16)),!0}else if(r.matchAny(["b","B"],!0)){for(;r.matchAny(["0","1","_"],!0););if(r.matchAny(["L","l"],!0)){let s=r.endSpan(),n=s.getText();return e.push(new L(i.LongLiteral,s,parseInt(n.substring(2,n.length-1).replace(/\_/g,""),2))),!0}return e.push(Re(r.endSpan(),2)),!0}r.reset(t)}if(r.matchDigit(!1)){let t=i.IntegerLiteral;for(r.startSpan();r.matchDigit(!0)||r.match("_",!0););if(r.match(i.Period.literal,!0))if(r.hasMore())for(t=i.DoubleLiteral;r.matchDigit(!0)||r.match("_",!0););else r.reset(r.getPosition()-1);if(r.matchAny(["b","B"],!0)){if(t===i.DoubleLiteral)throw new R("Byte literal can not have a decimal point.",r.endSpan());t=i.ByteLiteral}else if(r.matchAny(["s","S"],!0)){if(t===i.DoubleLiteral)throw new R("Short literal can not have a decimal point.",r.endSpan());t=i.ShortLiteral}else if(r.matchAny(["l","L"],!0)){if(t===i.DoubleLiteral)throw new R("Long literal can not have a decimal point.",r.endSpan());t=i.LongLiteral}else r.matchAny(["f","F"],!0)?t=i.FloatLiteral:r.matchAny(["d","D"],!0)?t=i.DoubleLiteral:r.matchAny(["m","M"],!0)&&(t=i.DecimalLiteral);return e.push(new L(t,r.endSpan(),null)),!0}return!1},xt=(r,e)=>{if(r.match("```",!0))if(r.startSpan(),r.matchIdentifierStart(!0)){for(;r.matchIdentifierPart(!0););let t=r.endSpan();if(e.push(new C(i.Language,t,null)),r.startSpan(),!r.skipUntil("```"))throw new R("```需要以```结尾",r.endSpan());return e.push(new C(i.Language,r.endSpan(-3),null)),!0}else{const t=r.getPosition(),s=r.getSpan(t,t+1);throw new R("```后需要标识语言类型",s)}return!1},_t=(r,e)=>{if(r.matchIdentifierStart(!0)){for(r.startSpan();r.matchIdentifierPart(!0););let t=r.endSpan();t=r.getSpan(t.getStart()-1,t.getEnd());const s=t.getText();return s==="true"||s==="false"?e.push(new L(i.BooleanLiteral,t,null)):s==="null"?e.push(new L(i.NullLiteral,t,null)):s==="instanceof"?e.push(new C(i.InstanceOf,t,null)):i.SqlAnd.literal.toUpperCase()===s.toUpperCase()?e.push(new C(i.SqlAnd,t,null)):i.SqlOr.literal.toUpperCase()===s.toUpperCase()?e.push(new C(i.SqlOr,t,null)):e.push(new C(i.Identifier,t,null)),!0}return!1},Pt=(r,e)=>{if(r.match("`",!0)){let t=r.getPosition(),s=t,n=!1,a=[];for(;r.hasMore();){if(r.match("\\",!0)){r.consume();continue}if(r.match("`",!0)){n=!0;break}if(r.match("${",!0)){let c=r.getPosition();s<c-2&&a.push(new L(i.StringLiteral,r.endSpan(s,c-2),null)),a.push(...ke(r,[],"}")),s=r.getPosition();continue}r.consume()}if(!n)throw new R("模板字符串未闭合",r.getSpan(t-1,r.getPosition()));let l=r.endSpan(t,r.getPosition()),o=r.getPosition()-1;return o-s>0&&a.push(new L(i.StringLiteral,r.endSpan(s,o),null)),l=r.getSpan(l.getStart()-1,l.getEnd()),e.push(new L(i.StringLiteral,l,new U(a))),!0}return!1},ke=(r,e,t)=>{let s=0,n=0;for(;r.hasMore();){if(r.skipWhiteSpace(),t&&r.match(t,!0))return e;if(r.match("//",!0)){r.skipLine();continue}if(r.match("/*",!0)){r.skipUntil("*/");continue}if(Ct(r,e)||J(r,i.SingleQuote,e)||J(r,i.TripleQuote,e)||J(r,i.DoubleQuote,e)||Lt(r,e)||xt(r,e)||Pt(r,e)||_t(r,e))continue;if(r.matchAny(["=>","->"],!0)){e.push(new C(i.Lambda,r.getSpan(r.getPosition()-2,r.getPosition()),null));continue}let a=!1;const l=i.getSortedValues();for(let o=0,c=l.length;o<c;o++){const h=l[o];if(h.literal!=null&&r.match(h.literal,!0)){h===i.LeftCurly&&s++,e.push(new C(h,r.getSpan(r.getPosition()-h.literal.length,r.getPosition()),null)),a=!0;break}}if(!a){if(s!==n&&r.match("}",!0)){n++,e.push(new C(i.RightCurly,r.getSpan(r.getPosition()-1,r.getPosition()),null));continue}if(r.hasMore())throw new R("Unknown token",r.getSpan(r.getPosition(),r.getPosition()+1))}}return e},q=r=>ke(new Nt(r,0,r.length),[],null);class m{span;constructor(e){this.span=e}getSpan(){return this.span}async getJavaType(e){return await this.getExpressionsJavaType(e),"java.lang.Object"}async getExpressionsJavaType(e){for(const t of this.expressions().filter(s=>s))await t.getJavaType(e)}expressions(){return[]}toString(){return this.span.getText()}}class b extends m{javaType;expressionList;constructor(e){super(e)}}class O extends b{constructor(e,t,s=[]){super(e),this.javaType=t,this.expressionList=s}expressions(){return this.expressionList||[]}async getJavaType(){return this.javaType||"java.lang.Object"}getValue(){return this.getSpan().getText().replace(/\\\\/g,"\\").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\"/g,'"').replace(/\\'/g,"'")}}class K extends m{target;args;constructor(e,t,s){super(e),this.target=t,this.args=s}expressions(){return[this.target,...this.args]}getMethod(){return this.target}getArguments(){return this.args}async getJavaType(e){const t=this.target.member.getText(),s=await this.target.getJavaType(e),n=d.findMethods(s);if(n){for(const a of n)if(a.name===t&&d.matchTypes(a.parameters,this.args,a.extension))return a.origin?s:d.getWrapperClass(a.returnType)}return"java.lang.Object"}}class Ee extends m{target;args;constructor(e,t,s){super(e),this.target=t,this.args=s}expressions(){return[this.target,...this.args]}getFunction(){return this.target}getArguments(){return this.args}async getJavaType(e){if(this.target instanceof P){const t=d.findFunction().find(s=>s.name===this.target.variable);if(t)return t.returnType}return await this.target.getJavaType(e)}}class M extends m{target;optional;member;whole;constructor(e,t,s,n,a=!1){super(e),this.target=t,this.optional=s,this.member=n,this.whole=a}isWhole(){return this.whole===!0}expressions(){return[this.target]}getTarget(){return this.target}async getJavaType(e){const t=await this.target.getJavaType(e),s=await d.loadClass(t);if(s?.attributes){const n=s.attributes.find(a=>a.name===this.member.getText());if(n)return d.getWrapperClass(n.type)}if(s?.enums){const n=s.enums.find(a=>a.name===this.member.getText());if(n)return d.getWrapperClass(n.type)}if(s?.methods){for(const n of s.methods)if(s.superClass==="java.util.HashMap"&&n.name==="get"&&n.parameters.length===1)return d.getWrapperClass(n.returnType)}return t||"java.lang.Object"}}class P extends m{variable;constructor(e,t){super(e),this.variable=t}getVariable(){return this.variable}async getJavaType(e){let t=e&&e[this.variable];if(!t){const s=e["@import"]||[];for(let n=s.length-1;n>=0&&!t;n--)t=d.findClass(s[n]+this.variable)}return t||"java.lang.Object"}}class H extends m{target;keyOrIndex;constructor(e,t,s){super(e),this.target=t,this.keyOrIndex=s}async getJavaType(e){return await this.target.getJavaType(e)==="db"?"db":super.getJavaType(e)}expressions(){return[this.target,this.keyOrIndex]}}class Ie extends m{condition;trueBlock;elseIfs;falseBlock;constructor(e,t,s=[],n=[],a=[]){super(e),this.condition=t,this.trueBlock=s,this.elseIfs=n,this.falseBlock=a}expressions(){return[this.condition,...this.trueBlock,...this.elseIfs,...this.falseBlock]}}class Oe extends O{constructor(e){super(e,"java.lang.Object",[])}}class Q extends m{parameters;childNodes;constructor(e,t,s){super(e),this.parameters=t,this.childNodes=s}expressions(){return[...this.childNodes]}async getJavaType(e){for(const s of this.parameters)e[s]="java.lang.Object";let t="java.lang.Object";for(const s of this.childNodes)s instanceof G&&await s.getJavaType(e),s instanceof w&&(t=await s.getJavaType(e)),await s.getJavaType(e);if(t==="java.lang.Object"&&this.childNodes.length>0){const s=this.childNodes[this.childNodes.length-1];s instanceof w||(t=await s.getJavaType(e))}return t}}class w extends m{returnValue;constructor(e,t){super(e),this.returnValue=t}expressions(){return this.returnValue?[this.returnValue]:[]}async getJavaType(e){return this.returnValue==null?"":await this.returnValue.getJavaType(e)}}class Dt extends m{constructor(e){super(e)}}class Mt extends m{constructor(e){super(e)}}class vt extends m{values;constructor(e,t){super(e),this.values=t}expressions(){return this.values}}class wt extends m{value;constructor(e,t){super(e),this.value=t}expressions(){return[this.value]}}class yt extends m{condition;values;constructor(e,t,s){super(e),this.condition=t,this.values=s}expressions(){return[this.condition,...this.values]}}class k extends m{identifier;parameters;constructor(e,t,s){super(e),this.identifier=t,this.parameters=s}expressions(){return[...this.parameters]}async getJavaType(e){let t=e[this.identifier];if(!t){const s=e["@import"]||[];for(let n=s.length-1;n>=0&&!t;n--)t=d.findClass(s[n]+this.identifier)}return t||"java.lang.Object"}}class Ut extends m{expression;constructor(e,t){super(e),this.expression=t}expressions(){return[this.expression]}async getJavaType(e){return"java.util.concurrent.Future"}}class Ne extends m{operator;operand;atAfter;constructor(e,t,s){super(new g(e.getSpan(),t.getSpan())),this.operator=e,this.operand=t,this.atAfter=s}async getJavaType(e){return await this.operand.getJavaType(e)}expressions(){return[this.operand]}}class bt extends m{exceptionVarNode;tryBlock;tryResources;catchBlock;finallyBlock;constructor(e,t,s,n,a,l){super(e),this.exceptionVarNode=t,this.tryBlock=s,this.tryResources=n,this.catchBlock=a,this.finallyBlock=l}expressions(){return[...this.tryBlock,...this.tryResources,...this.catchBlock,...this.finallyBlock]}}class Ft extends m{indexOrKey;value;mapOrArray;body;constructor(e,t,s,n,a){super(e),this.indexOrKey=t,this.value=s,this.mapOrArray=n,this.body=a}expressions(){return[this.mapOrArray,...this.body]}}class Bt extends m{condition;trueBlock;constructor(e,t,s){super(e),this.condition=t,this.trueBlock=s}expressions(){return[this.condition,...this.trueBlock]}}class kt extends m{packageName;varName;module;constructor(e,t,s,n){super(e),this.packageName=t,this.varName=s,this.module=n}async getJavaType(e){if(this.packageName.endsWith(".*"))e["@import"].push(this.packageName.substring(0,this.packageName.length-1));else if(this.module)e[this.packageName]=this.packageName;else if(this.varName)e[this.varName]=this.packageName;else{const t=this.packageName.lastIndexOf(".");t>-1&&(e[this.packageName.substring(t+1)]=this.packageName)}}}class G extends m{varName;expression;defineType;constructor(e,t,s,n){super(e),this.varName=t,this.expression=s,this.defineType=n}getVarName(){return this.varName}expressions(){return this.expression?[this.expression]:[]}async getJavaType(e){let t="java.lang.Object";return this.defineType&&!["var","const","let"].includes(this.defineType||"")?t=e[this.defineType]||t:this.expression&&(t=await this.expression.getJavaType(e)),e[this.varName]===void 0&&(e[this.varName]=t),t}}class Ye extends G{tokens;isMapAccess;constructor(e,t,s,n,a=!0){super(e,"",s,n),this.tokens=t,this.isMapAccess=a}getIdentifiers(){return this.tokens}isObjectDestructuring(){return this.isMapAccess}expressions(){return this.expression?[this.expression]:[]}async getJavaType(e){let t="java.lang.Object";if(this.defineType&&!["var","const","let"].includes(this.defineType||""))t=e[this.defineType]||t;else if(!this.isMapAccess)return t;for(const s of this.tokens)if(this.expression){const n=new M(s.getSpan(),this.expression,!1,s,!1);e[s.getText()]=await n.getJavaType(e)}else e[s.getText()]="java.lang.Object";return t}}class Le extends m{condition;trueExpression;falseExpression;constructor(e,t,s){super(new g(e.getSpan(),s.getSpan())),this.condition=e,this.trueExpression=t,this.falseExpression=s}expressions(){return[this.condition,this.trueExpression,this.falseExpression]}}class Yt extends m{target;constructor(e,t){super(e),this.target=t}expressions(){return[this.target]}}class Gt extends O{keys;values;constructor(e,t,s){super(e,"java.util.LinkedHashMap",[]),this.keys=t,this.values=s}expressions(){return this.values}}class Vt extends O{values;constructor(e,t){super(e,"java.util.ArrayList",[]),this.values=t}expressions(){return this.values}}class Ht extends m{constructor(e){super(e)}async getJavaType(){return"java.util.function.Function"}expressions(){return[]}}class Ce extends m{left;right;operator;linqLevel;constructor(e,t,s,n){super(new g(e.getSpan(),s.getSpan())),this.left=e,this.right=s,this.operator=t,this.linqLevel=n}getOperator(){return this.operator}setRightOperand(e){this.right=e}getRightOperand(){return this.right}expressions(){return[this.left,this.right]}async getJavaType(e){let t=await this.left.getJavaType(e),s=await this.right.getJavaType(e);return t=t.toLowerCase().substring(t.lastIndexOf(".")+1),s=s.toLowerCase().substring(s.lastIndexOf(".")+1),(this.operator.type===i.Plus||this.operator.type===i.PlusEqual)&&(t==="string"||s==="string")?"java.lang.String":this.operator.type===i.Equal||this.operator.type===i.Assignment&&this.linqLevel>0?"java.lang.Boolean":t==="bigdecimal"||s==="bigdecimal"?"java.math.BigDecimal":t==="double"||s==="double"?"java.lang.Double":t==="float"||s==="float"?"java.lang.Float":t==="long"||s==="long"?"java.lang.Long":t==="integer"||s==="integer"?"java.lang.Integer":t==="short"||s==="short"?"java.lang.Short":t==="byte"||s==="byte"?"java.lang.Byte":"java.lang.Object"}}class F extends b{expression;alias;constructor(e,t,s){super(e),this.expression=t,this.alias=s}expressions(){return[this.expression]}}class Kt extends b{leftJoin;target;condition;constructor(e,t,s,n){super(e),this.leftJoin=t,this.target=s,this.condition=n}expressions(){return[this.target,this.condition]}}class jt extends b{expression;alias;order;constructor(e,t,s,n){super(e),this.expression=t,this.alias=s,this.order=n}expressions(){return[this.expression]}}class Ge extends b{convert;target;args;constructor(e,t,s,n){super(e),this.convert=t,this.target=s,this.args=n}expressions(){return[this.target,...this.args]}async getJavaType(){switch(this.convert){case"double":return"java.lang.Double";case"float":return"java.lang.Float";case"long":return"java.lang.Long";case"int":return"java.lang.Integer";case"short":return"java.lang.Short";case"byte":return"java.lang.Byte";case"date":return"java.util.Date";default:return"java.lang.Object"}}}class Ve extends b{fields;from;joins;where;groups;having;orders;limit;offset;constructor(e,t,s,n,a,l=[],o,c=[],h,u){super(e),this.fields=t,this.from=s,this.joins=n,this.where=a,this.groups=l,this.having=o,this.orders=c,this.limit=h,this.offset=u}expressions(){const e=[];return this.where&&e.push(this.where),this.having&&e.push(this.having),[...this.fields,this.from,...this.joins,...this.groups,...e,...this.orders,...this.limit?[this.limit]:[],...this.offset?[this.offset]:[]]}async getJavaType(){return"java.util.List"}}const de={environmentFunction:()=>{},setEnvironment:r=>de.environmentFunction=r};class ue{static enhanceError(e,t,s){const n=e.toLowerCase();return n.includes("expected")&&n.includes("but got")?this.enhanceSyntaxError(e,t,s):n.includes("变量名")&&n.includes("不能定义")?this.enhanceVariableNameError(e,t,s):this.isObjectLiteralError(n,s)?this.enhanceObjectLiteralError(e,t,s):n.includes("identifier")||n.includes("变量名")?this.enhanceIdentifierError(e,t,s):n.includes("字符串")||n.includes("string")?this.enhanceStringError(e,t,s):n.includes("括号")||n.includes("bracket")?this.enhanceBracketError(e,t,s):n.includes("关键字")||n.includes("keyword")?this.enhanceKeywordError(e,t,s):n.includes("linq")?this.enhanceLinqError(e,t,s):this.createDefaultError(e,t)}static isObjectLiteralError(e,t){return e.includes("literal cannot be used alone")&&e.includes("期望变量、字段、映射、数组、函数或方法调用")||t&&t.inObjectLiteral}static enhanceObjectLiteralError(e,t,s){return e.includes("literal cannot be used alone")?{message:"对象字面量数字或字面量不能单独出现在键值对中",suggestion:"请检查对象字面量的格式是否正确。每个键值对应该是 '键: 值' 的形式，多个键值对之间用逗号分隔。",span:t,severity:"error",code:"OBJECT_LITERAL_SYNTAX"}:e.includes("期望变量、字段、映射、数组、函数或方法调用")?{message:"对象字面量结构错误",suggestion:"请检查对象字面量的结构：1. 确保每个键值对格式为 '键: 值' 2. 键值对之间用逗号分隔 3. 最后一个键值对后面不要加逗号 4. 检查是否有多余的符号或缺少必要的符号",span:t,severity:"error",code:"OBJECT_LITERAL_STRUCTURE"}:{message:"对象字面量语法错误",suggestion:"对象字面量应该遵循格式：{ 键1: 值1, 键2: 值2, ... }。请检查是否有语法错误。",span:t,severity:"error",code:"OBJECT_LITERAL_ERROR"}}static enhanceSyntaxError(e,t,s){const n=e.match(/Expected ['"]([^'"]+)['"]/),a=e.match(/but got ['"]([^'"]+)['"]/),l=n?n[1]:"某个符号",o=a?a[1]:"未知符号";return{message:`期望的是'${l}'，但实际是'${o}'`,suggestion:this.getSyntaxSuggestion(l,o,s),span:t,severity:"error",code:"SYNTAX_ERROR"}}static enhanceIdentifierError(e,t,s){return{message:"需要有效的标识符（变量名、函数名等）",suggestion:"请提供一个以字母或下划线开头的有效名称，不能使用数字开头或特殊字符",span:t,severity:"error",code:"IDENTIFIER_EXPECTED"}}static enhanceStringError(e,t,s){return{message:"字符串没有正确闭合",suggestion:`请检查字符串是否以${e.includes("'")?"单引号":e.includes('"')?"双引号":"引号"}正确结尾，多行字符串需要使用三引号"""`,span:t,severity:"error",code:"UNCLOSED_STRING"}}static enhanceBracketError(e,t,s){const n={"(":"圆括号","[":"方括号","{":"花括号"},a=s?.bracketType||"(",l=n[a]||"括号";return{message:`${l}没有正确闭合`,suggestion:`请检查每个${l}都有对应的闭合符号`,span:t,severity:"error",code:"UNMATCHED_BRACKET"}}static enhanceKeywordError(e,t,s){const n=e.match(/['"]([^'"]+)['"]/);return{message:`'${n?n[1]:"该关键字"}'是保留关键字，不能用作变量名`,suggestion:"请选择其他名称，避免使用语言内置的关键字如：if, for, while, return等",span:t,severity:"error",code:"RESERVED_KEYWORD"}}static enhanceVariableNameError(e,t,s){const n=e.match(/['"]([^'"]+)['"]/),a=n?n[1]:"该变量";return/^\d/.test(a)?{message:`变量名'${a}'以数字开头，不符合命名规范`,suggestion:"变量名应以字母或下划线开头，不能以数字开头。请修改为有效的标识符，例如：var myVar = '123';",span:t,severity:"error",code:"INVALID_VARIABLE_NAME"}:["var","let","const","if","for","while","return","function","class"].includes(a)?{message:`'${a}'是保留关键字，不能用作变量名`,suggestion:"请选择其他名称，避免使用语言内置的关键字",span:t,severity:"error",code:"RESERVED_KEYWORD"}:{message:`变量名'${a}'不符合命名规范`,suggestion:"变量名只能包含字母、数字、下划线，且不能以数字开头。请修改为有效的标识符。",span:t,severity:"error",code:"INVALID_VARIABLE_NAME"}}static enhanceLinqError(e,t,s){return{message:"LINQ查询语法不正确",suggestion:"LINQ查询应该遵循格式：from 变量 in 数据源 [where 条件] [select 表达式]",span:t,severity:"error",code:"LINQ_SYNTAX_ERROR"}}static createDefaultError(e,t){return{message:`${e}`,suggestion:"",span:t,severity:"error",code:"GENERIC_ERROR"}}static getSyntaxSuggestion(e,t,s){const n={",":"可能需要添加逗号分隔多个参数或元素",";":"语句应该以分号结尾","(":"函数调用或表达式需要括号",")":"括号没有正确闭合","{":"代码块需要花括号","}":"花括号没有正确闭合","=":"赋值操作需要使用等号","==":"比较操作应该使用双等号或三等号",":":"对象字面量中键值对应该使用冒号分隔"};return s&&s.inObjectLiteral?{",":"对象字面量中键值对之间应该用逗号分隔",":":"对象字面量中键和值之间应该用冒号分隔","}":"对象字面量应该用花括号正确闭合",identifier:"对象字面量的键应该是有效的标识符或字符串"}[e]||n[e]||"请检查对象字面量的语法结构":n[e]||"请检查语法结构是否正确"}static formatErrorLocation(e){const t=e.getLine();return`第${t.lineNumber}行，第${t.startCol}列`}static generateErrorReport(e){if(e.length===0)return"✅ 代码语法正确";let t=`发现 ${e.length} 个语法问题：

`;return e.forEach((s,n)=>{const a=this.formatErrorLocation(s.span);t+=`${n+1}. ${s.message}
`,t+=`   位置：${a}
`,t+=`   建议：${s.suggestion}
`,t+=`   代码：${s.code}

`}),t}}const xe=["import","as","var","let","const","return","break","continue","if","for","in","new","true","false","null","else","try","catch","finally","async","while","exit","and","or","instanceof","throw"],_e=["from","join","left","group","by","as","having","and","or","in","where","on","limit","offset"],qt=[[i.Assignment],[i.RShift2Equal,i.RShiftEqual,i.LShiftEqual,i.XorEqual,i.BitOrEqual,i.BitAndEqual,i.PercentEqual,i.ForwardSlashEqual,i.AsteriskEqual,i.MinusEqual,i.PlusEqual],[i.Or,i.SqlOr],[i.And,i.SqlAnd],[i.BitOr],[i.Xor],[i.BitAnd],[i.EqualEqualEqual,i.Equal,i.NotEqualEqual,i.NotEqual,i.SqlNotEqual,i.InstanceOf],[i.Less,i.LessEqual,i.Greater,i.GreaterEqual],[i.Plus,i.Minus],[i.LShift,i.RShift,i.RShift2],[i.Asterisk,i.ForwardSlash,i.Percentage]],Wt=[[i.RShift2Equal,i.RShiftEqual,i.LShiftEqual,i.XorEqual,i.BitOrEqual,i.BitAndEqual,i.PercentEqual,i.ForwardSlashEqual,i.AsteriskEqual,i.MinusEqual,i.PlusEqual],[i.Or,i.SqlOr],[i.And,i.SqlAnd],[i.BitOr],[i.Xor],[i.BitAnd],[i.Assignment,i.EqualEqualEqual,i.Equal,i.NotEqualEqual,i.Equal,i.NotEqual,i.SqlNotEqual],[i.Less,i.LessEqual,i.Greater,i.GreaterEqual],[i.Plus,i.Minus],[i.LShift,i.RShift,i.RShift2],[i.Asterisk,i.ForwardSlash,i.Percentage]],$t=[i.MinusMinus,i.PlusPlus,i.BitNot,i.Minus,i.Plus,i.Not];class W{errors=[];stream;linqLevel;constructor(e){this.stream=e,this.linqLevel=0}getErrors(){return this.errors}getErrorReport(){return ue.generateErrorReport(this.errors)}addError(e,t,s){const n=ue.enhanceError(e,t,s);this.errors.push(n)}parse(e){let t=[];try{for(;this.stream.hasMore();)try{let s=this.parseStatement();s!=null&&(this.validateNode(s),t.push(s))}catch(s){this.addError(s.message,s.span,{currentToken:this.stream.getPrev()?.getText(),nextToken:this.stream.hasNext()?this.stream.getToken(!1)?.getText():void 0,linqLevel:this.linqLevel})}}catch(s){if(e!==!0)throw s}return t}async parseEnv(){return await this.processEnv(this.parse(!0))}async parseBest(e){let t=this.parse(!0),s=await this.processEnv(t);return{best:this.findBestMatch(t[t.length-1],e),env:s}}async processEnv(e){let t=e.length,s={...de.environmentFunction(),...d.getAutoImportClass(),...d.getAutoImportModule(),"@import":[]};for(let n=0;n<t;n++)await e[n].getJavaType(s);return s}validateNode(e){if(e instanceof O)throw new R("字面量（数字、字符串等）不能单独作为语句使用，需要赋值给变量或作为表达式的一部分",e.getSpan())}parseStatement(e){let t=null;if(this.stream.match("import",!1))t=this.parseImport();else if(this.matchVarDefine())t=this.parseVarDefine();else if(this.stream.match("if",!1))t=this.parseIfStatement();else if(this.stream.match("return",!1))t=this.parseReturn();else if(this.stream.match("for",!1))t=this.parseForStatement();else if(this.stream.match("while",!1))t=this.parseWhileStatement();else if(this.stream.match("continue",!1))t=new Dt(this.stream.consume().getSpan());else if(this.stream.match("async",!1))t=this.parseAsync();else if(this.stream.match("try",!1))t=this.parseTryStatement();else if(this.stream.match("break",!1))t=new Mt(this.stream.consume().getSpan());else if(this.stream.match("exit",!1))t=this.parseExit();else if(this.stream.match("throw",!1))t=this.parseThrow();else if(this.stream.match("assert",!1))t=this.parseAssert();else{let s=this.stream.makeIndex();this.matchTypeDefine()&&(this.stream.resetIndex(s),t=this.parseVarDefine()),t==null&&(this.stream.resetIndex(s),t=this.parseExpression(e))}for(;this.stream.match(";",!0););return t}matchTypeDefine(){return this.stream.match(i.Identifier,!0)&&this.stream.match(i.Identifier,!1)}matchVarDefine(){return this.stream.match(["var","let","const"],!1)}checkKeyword(e){if(xe.indexOf(e.getText())>-1)throw new R(`变量名不能定义为关键字 '${e.getText()}'`,e)}parseThrow(){let e=this.stream.consume().getSpan(),t=this.parseExpression();return new wt(new g(e,this.stream.getPrev().getSpan()),t)}parseExit(){let e=this.stream.expect("exit").getSpan(),t=[];do t.push(this.parseExpression());while(this.stream.match(i.Comma,!0));return new vt(new g(e,this.stream.getPrev().getSpan()),t)}parseAssert(){let e=this.stream.makeIndex();try{let t=this.stream.expect("assert").getSpan(),s=this.parseExpression();this.stream.expect(i.Colon);let n=[];do n.push(this.parseExpression());while(this.stream.match(i.Comma,!0));return new yt(new g(t,this.stream.getPrev().getSpan()),s,n)}catch{return this.stream.resetIndex(e),this.parseExpression()}}parseImport(){let e=this.stream.expect("import").getSpan();if(this.stream.hasMore()){let t=this.stream.consume(),s=null,n=t.getTokenType()===i.StringLiteral;if(n)s=this.createStringLiteral(t).getValue();else if(t.type===i.Identifier){let l=t.getSpan(),o=null;for(s=l.getText();this.stream.match(i.Period,!0);){if(n=!0,this.stream.match(i.Asterisk,!1)){t=this.stream.consume();break}t=this.stream.expect(i.Identifier)}n&&(o=t.getSpan(),s=new g(l,o).getText())}else throw new R("Expected identifier or string, but got stream is "+t.getTokenType().error,this.stream.getPrev().getSpan());let a=s;if(n)if(this.stream.match("as",!0))t=this.stream.expect(i.Identifier),this.checkKeyword(t.getSpan()),a=t.getSpan().getText();else{let l=s;if(l.startsWith("@"))throw new R("Expected as",this.stream.getPrev().getSpan());{let o=l.lastIndexOf(".");o!=-1&&(l=l.substring(o+1))}a=l}return new kt(new g(e,t.getSpan()),s,a,!n)}throw new R("Expected identifier or string, but got stream is EOF",this.stream.getPrev().getSpan())}parseReturn(){let e=this.stream.expect("return").getSpan();if(this.stream.match(";",!1))return new w(e,null);let t=this.parseExpression();return new w(new g(e,t.getSpan()),t)}parseAsync(){let e=this.stream.expect("async").getSpan(),t=this.parseExpression();return new Ut(new g(e,this.stream.getPrev().getSpan()),t)}parseIfStatement(){let e=this.stream.expect("if").getSpan(),t=this.parseExpression(),s=this.parseFunctionBody(),n=[],a=[];for(;this.stream.hasMore()&&this.stream.match("else",!0);)if(this.stream.hasMore()&&this.stream.match("if",!1)){let o=this.stream.expect("if").getSpan(),c=this.parseExpression(),h=this.parseFunctionBody(),u=new g(o,h.length>0?h[h.length-1].getSpan():o);n.push(new Ie(u,c,h,[]))}else{a=a.concat(this.parseFunctionBody());break}let l=this.stream.getPrev().getSpan();return new Ie(new g(e,l),t,s,n,a)}parseNewExpression(e){let t=this.parseAccessOrCall(i.Identifier,!0),s=new g(e.getSource(),e.getStart(),this.stream.getPrev().getSpan().getEnd());return t instanceof K?this.parseAccessOrCall(new k(s,t.getMethod(),t.getArguments())):t instanceof Ee?this.parseAccessOrCall(new k(s,t.getFunction(),t.getArguments())):this.parseAccessOrCall(new k(s,t,[]))}parseArguments(){this.stream.expect(i.LeftParantheses);let e=[];for(;this.stream.hasMore()&&!this.stream.match(i.RightParantheses,!1);)e.push(this.parseExpression()),this.stream.match(i.RightParantheses,!1)||this.stream.expect(i.Comma);return e}parseForStatement(){let e=this.stream.expect("for").getSpan();this.stream.expect("(");let t=null,s=this.stream.expect(i.Identifier).getSpan();this.checkKeyword(s),this.stream.match(i.Comma,!0)&&(t=s,s=this.stream.expect(i.Identifier).getSpan(),this.checkKeyword(s)),this.stream.expect("in");let n=this.parseExpression();this.stream.expect(")");let a=this.parseFunctionBody();return new Ft(new g(e,this.stream.getPrev().getSpan()),t&&t.getText(),s&&s.getText(),n,a)}parseVarDefine(){let e=this.stream.consume().getSpan(),t,s=[];if((t=this.stream.match(i.LeftCurly,!1))||this.stream.match(i.LeftBracket,!1)){this.stream.expect([i.LeftCurly,i.LeftBracket]);do{let l=this.stream.expect(i.Identifier);s.push(l)}while(this.stream.match(i.Comma,!0));return t?this.stream.match(i.RightCurly,!0):this.stream.match(i.RightBracket,!0),this.stream.match(i.Assignment,!0),new Ye(new g(e,this.stream.getPrev().getSpan()),s,this.parseExpression(),e.getText(),t)}let n=this.stream.expect(i.Identifier);this.checkKeyword(n.getSpan());let a;return this.stream.match(i.Assignment,!0)?a=new G(new g(e,this.stream.getPrev().getSpan()),n.getText(),this.parseExpression(),e.getText()):a=new G(new g(e,this.stream.getPrev().getSpan()),n.getText(),null,e.getText()),a}parseTryStatement(){let e=this.stream.expect("try"),t=[];if(this.stream.match("(",!0)){if(!this.stream.match(")",!1))for(;!this.stream.match(")",!1);){if(this.stream.match(";",!0))continue;let o=null;if(this.matchVarDefine())o=this.parseVarDefine();else{if(this.stream.matchAny(xe,!1))throw new R("try 括号中只允许写赋值语句",this.stream.consume().getSpan());let c=this.stream.makeIndex();if(this.matchTypeDefine()&&(this.stream.resetIndex(c),o=this.parseVarDefine()),o==null)throw this.stream.resetIndex(c),new R("try 括号中只允许写赋值语句",this.stream.consume().getSpan())}t.push(o)}this.stream.expect(")")}let s=this.parseFunctionBody(),n=[],a=[],l=null;return this.stream.match("catch",!0)&&(this.stream.match("(",!0)&&(l=this.stream.expect(i.Identifier).getText(),this.stream.expect(")")),n=n.concat(this.parseFunctionBody())),this.stream.match("finally",!0)&&(a=a.concat(this.parseFunctionBody())),new bt(new g(e.getSpan(),this.stream.getPrev().getSpan()),l,s,t,n,a)}parseWhileStatement(){let e=this.stream.expect("while").getSpan(),t=this.parseExpression(),s=this.parseFunctionBody(),n=this.stream.getPrev().getSpan();return new Bt(new g(e,n),t,s)}parseFunctionBody(){this.stream.expect("{");let e=[];for(;this.stream.hasMore()&&!this.stream.match("}",!1);){let t=this.parseStatement(!0);t!=null&&(this.validateNode(t),e.push(t))}return this.expectCloseing(),e}expectCloseing(){return this.stream.hasMore(),this.stream.expect("}").getSpan()}parseExpression(e){return this.parseTernaryOperator(e)}parseTernaryOperator(e){let t=this.parseBinaryOperator(0,e);if(this.stream.match(i.Questionmark,!0)){let s=this.parseTernaryOperator(e);this.stream.expect(i.Colon);let n=this.parseTernaryOperator(e);return t instanceof Ce&&t.getOperator()===i.Assignment?(t.setRightOperand(new Le(t.getRightOperand(),s,n)),t):new Le(t,s,n)}else return t}parseBinaryOperator(e,t){let s=e+1,n=this.linqLevel>0?Wt:qt,a=s===n.length?this.parseUnaryOperator(t):this.parseBinaryOperator(s,t),l=n[e];for(;this.stream.hasMore()&&this.stream.match(l,!1);){let o=this.stream.consume();if(o.type.inLinq&&this.linqLevel===0)throw new R(o.getText()+" 只能在Linq中使用",this.stream.hasMore()?this.stream.consume().getSpan():this.stream.getPrev().getSpan());let c=s===n.length?this.parseUnaryOperator(t):this.parseBinaryOperator(s,t);a=new Ce(a,o,c,this.linqLevel)}return a}parseUnaryOperator(e){if(this.stream.match($t,!1))return new Ne(this.stream.consume(),this.parseUnaryOperator(e));if(this.stream.match(i.LeftParantheses,!1)){let t=this.stream.expect(i.LeftParantheses).getSpan(),s=this.stream.makeIndex(),n=[];for(;this.stream.match(i.Identifier,!1);){let l=this.stream.expect(i.Identifier);if(n.push(l.getSpan().getText()),!this.stream.match(i.Comma,!0)&&this.stream.match(i.RightParantheses,!0)){if(this.stream.match(i.Lambda,!0))return this.parseLambdaBody(t,n);break}}if(this.stream.match(i.RightParantheses,!0)&&this.stream.match(i.Lambda,!0))return this.parseLambdaBody(t,n);this.stream.resetIndex(s);let a=this.parseExpression();return this.stream.expect(i.RightParantheses),this.parseAccessOrCall(a)}else{let t=this.parseAccessOrCallOrLiteral(e);return(t instanceof M||t instanceof P||t instanceof H)&&this.stream.match([i.PlusPlus,i.MinusMinus],!1)?new Ne(this.stream.consume(),t):t}}parseLambdaBody(e,t){let s=this.stream.makeIndex(),n=[];try{let a=this.parseExpression();return n.push(new w(new g("return",0,6),a)),new Q(new g(e,a.getSpan()),t,n)}catch{if(this.stream.resetIndex(s),this.stream.match(i.LeftCurly,!0)){for(;this.stream.hasMore()&&!this.stream.match("}",!1);){let o=this.parseStatement(!0);this.validateNode(o),n.push(o)}let l=this.expectCloseing();return new Q(new g(e,l),t,n)}else{let l=this.parseStatement();return n.push(new w(new g("return",0,6),l)),new Q(new g(e,l.getSpan()),t,n)}}}parseSpreadAccess(e){e||(e=this.stream.expect(i.Spread));let t=this.parseExpression();return new Yt(new g(e.getSpan(),t.getSpan()),t)}parseAccessOrCall(e,t){if(e===i.StringLiteral||e===i.Identifier){let s=this.stream.expect(e),n=s.getSpan();if(e===i.Identifier&&n.getText()==="new")return this.parseNewExpression(n);if(e===i.Identifier&&this.stream.match(i.Lambda,!0))return this.parseLambdaBody(n,[n.getText()]);let a=e===i.StringLiteral?this.createStringLiteral(s):new P(n,n.getText());return this.parseAccessOrCall(a,t)}else{for(;this.stream.hasMore()&&this.stream.match([i.LeftParantheses,i.LeftBracket,i.Period,i.QuestionPeriod,i.ColonColon],!1);)if(this.stream.match(i.ColonColon,!1)){let s=this.stream.consume().getSpan(),n=[],a=this.stream.expect(i.Identifier),l=a.getSpan();this.stream.match(i.LeftParantheses,!1)&&(n=this.parseArguments(),l=this.stream.expect(i.RightParantheses).getSpan()),e=new Ge(new g(s,l),a.getText(),e,n)}else if(this.stream.match(i.LeftParantheses,!1)){let s=this.parseArguments(),n=this.stream.expect(i.RightParantheses).getSpan();if(e instanceof P||e instanceof H)e=new Ee(new g(e.getSpan(),n),e,s,this.linqLevel>0);else if(e instanceof M)e=new K(new g(e.getSpan(),n),e,s,this.linqLevel>0);else throw new R("Expected a variable, field or method.",this.stream.hasMore()?this.stream.consume().getSpan():this.stream.getPrev().getSpan());if(t)break}else if(this.stream.match(i.LeftBracket,!0)){let s=this.parseExpression(),n=this.stream.expect(i.RightBracket).getSpan();e=new H(new g(e.getSpan(),n),e,s)}else if(this.stream.match([i.Period,i.QuestionPeriod],!1)){let s=this.stream.consume().getTokenType()===i.QuestionPeriod;if(this.linqLevel>0&&this.stream.match(i.Asterisk,!1))e=new M(e,s,this.stream.expect(i.Asterisk).getSpan(),!0);else{let n=this.stream.expect([i.Identifier,i.SqlAnd,i.SqlOr]).getSpan();e=new M(new g(e.getSpan(),n),e,s,n,!1)}}return e}}parseMapLiteral(){let e=this.stream.expect(i.LeftCurly).getSpan(),t=[],s=[];for(;this.stream.hasMore()&&!this.stream.match("}",!1);){let a;if(this.stream.hasPrev()){let l=this.stream.getPrev();if(this.stream.match(i.Spread,!1)&&(l.getTokenType()===i.LeftCurly||l.getTokenType()===i.Comma)){let o=this.stream.expect(i.Spread);t.push(o),s.push(this.parseSpreadAccess(o)),this.stream.match([i.Comma,i.RightCurly],!1)&&this.stream.match(i.Comma,!0);continue}}this.stream.match(i.StringLiteral,!1)?a=this.stream.expect(i.StringLiteral):this.stream.match(i.LeftBracket,!0)?(a=this.parseExpression(),this.stream.expect(i.RightBracket)):a=this.stream.expect(i.Identifier),t.push(a),this.stream.match([i.Comma,i.RightCurly],!1)?(this.stream.match(i.Comma,!0),a instanceof P?s.push(a):a.getTokenType()===i.Identifier?s.push(new P(a.getSpan(),a.getText())):s.push(new O(a.getSpan(),"java.lang.String"))):(this.stream.expect(":"),s.push(this.parseExpression()),this.stream.match("}",!1)||this.stream.expect(i.Comma))}let n=this.stream.expect("}").getSpan();return new Gt(new g(e,n),t,s)}parseListLiteral(){let e=this.stream.expect(i.LeftBracket).getSpan(),t=[];for(;this.stream.hasMore()&&!this.stream.match(i.RightBracket,!1);)t.push(this.parseExpression()),this.stream.match(i.RightBracket,!1)||this.stream.expect(i.Comma);let s=this.stream.expect(i.RightBracket).getSpan();return new Vt(new g(e,s),t)}parseSelect(){let e=this.stream.expect("select",!0).getSpan();this.linqLevel++;let t=this.parseLinqFields();this.stream.expect("from",!0);let s=this.parseLinqField(),n=this.parseLinqJoins(),a;this.stream.match("where",!0,!0)&&(a=this.parseExpression());let l=this.parseGroup(),o;this.stream.match("having",!0,!0)&&(o=this.parseExpression());let c=this.parseLinqOrders();this.linqLevel--;let h,u;this.stream.match("limit",!0,!0)&&(h=this.parseExpression(),this.stream.match("offset",!0,!0)&&(u=this.parseExpression()));let E=this.stream.getPrev().getSpan();return new Ve(new g(e,E),t,s,n,a,l,o,c,h,u)}parseGroup(){let e=[];if(this.stream.match("group",!0,!0)){this.stream.expect("by",!0);do{let t=this.parseExpression();e.push(new F(t.getSpan(),t,null))}while(this.stream.match(i.Comma,!0))}return e}parseLinqOrders(){let e=[];if(this.stream.match("order",!0,!0)){this.stream.expect("by",!0);do{let t=this.parseExpression(),s=1;this.stream.match(["desc","asc"],!1,!0)&&this.stream.consume().getText()==="desc"&&(s=-1),e.push(new jt(new g(t.getSpan(),this.stream.getPrev().getSpan()),t,null,s))}while(this.stream.match(i.Comma,!0))}return e}parseLinqField(){let e=this.parseExpression();if(this.stream.match(i.Identifier,!1)&&!this.stream.match(_e,!1,!0)){let t=this.stream.expect(i.Identifier).getSpan();return new F(new g(e.getSpan(),t),e,t.getText())}return new F(e.getSpan(),e,null)}parseLinqFields(){let e=[];do{let t=this.parseExpression();if(this.stream.match(i.Identifier,!1)&&!this.stream.match(_e,!1,!0)){if(t instanceof Oe)throw new R("* 后边不能跟别名",this.stream.hasMore()?this.stream.consume().getSpan():this.stream.getPrev().getSpan());if(t instanceof M&&t.isWhole())throw new R(t.getSpan().getText()+" 后边不能跟别名",this.stream.hasMore()?this.stream.consume().getSpan():this.stream.getPrev().getSpan());let s=this.stream.consume().getSpan();e.push(new F(new g(t.getSpan(),s),t,s.getText()))}else e.push(new F(t.getSpan(),t,null))}while(this.stream.match(i.Comma,!0));if(e.length===0)throw new R("至少要查询一个字段",this.stream.hasMore()?this.stream.consume().getSpan():this.stream.getPrev().getSpan());return e}parseLinqJoins(){let e=[];do{let t=this.stream.match("left",!1),s=t?this.stream.consume().getSpan():null;if(this.stream.match("join",!0)){s=t?s:this.stream.getPrev().getSpan();let n=this.parseLinqField();this.stream.expect("on");let a=this.parseExpression();e.push(new Kt(new g(s,this.stream.getPrev().getSpan()),t,n,a))}}while(this.stream.match(["left","join"],!1));return e}parseAccessOrCallOrLiteral(e){let t;if(e&&this.stream.match("}",!1))return null;if(this.stream.match(i.Spread,!1))t=this.parseSpreadAccess();else if(this.stream.match(i.Identifier,!1))this.stream.match("async",!1)?t=this.parseAsync():this.stream.match("select",!1,!0)?t=this.parseSelect():t=this.parseAccessOrCall(i.Identifier);else if(this.stream.match(i.LeftCurly,!1))t=this.parseMapLiteral();else if(this.stream.match(i.LeftBracket,!1))t=this.parseListLiteral();else if(this.stream.match(i.StringLiteral,!1))t=this.createStringLiteral(this.stream.expect(i.StringLiteral));else if(this.stream.match(i.BooleanLiteral,!1))t=new O(this.stream.expect(i.BooleanLiteral).getSpan(),"java.lang.Boolean");else if(this.stream.match(i.DoubleLiteral,!1))t=new O(this.stream.expect(i.DoubleLiteral).getSpan(),"java.lang.Double");else if(this.stream.match(i.FloatLiteral,!1))t=new O(this.stream.expect(i.FloatLiteral).getSpan(),"java.lang.Float");else if(this.stream.match(i.ByteLiteral,!1))t=new O(this.stream.expect(i.ByteLiteral).getSpan(),"java.lang.Byte");else if(this.stream.match(i.ShortLiteral,!1))t=new O(this.stream.expect(i.ShortLiteral).getSpan(),"java.lang.Short");else if(this.stream.match(i.IntegerLiteral,!1))t=new O(this.stream.expect(i.IntegerLiteral).getSpan(),"java.lang.Integer");else if(this.stream.match(i.LongLiteral,!1))t=new O(this.stream.expect(i.LongLiteral).getSpan(),"java.lang.Long");else if(this.stream.match(i.DecimalLiteral,!1))t=new O(this.stream.expect(i.DecimalLiteral).getSpan(),"java.math.BigDecimal");else if(this.stream.match(i.RegexpLiteral,!1)){let s=this.stream.expect(i.RegexpLiteral);t=new O(s.getSpan(),"java.util.regex.Pattern")}else this.stream.match(i.NullLiteral,!1)?t=new O(this.stream.expect(i.NullLiteral).getSpan(),"null"):this.linqLevel>0&&this.stream.match(i.Asterisk,!1)?t=new Oe(this.stream.expect(i.Asterisk).getSpan()):this.stream.match(i.Language,!1)&&(t=new Ht(this.stream.consume().getSpan(),this.stream.consume().getSpan()));if(t==null){const s=this.stream.hasNext()?this.stream.getToken(!1):null;let a=`期望变量、字段、映射、数组、函数或方法调用，但发现了${s?`'${s.getText()}'`:"文件结尾"}`;if(s){const l=s.getText();l===","?a="逗号使用不当，可能缺少表达式或多余的逗号":l===":"?a="冒号使用不当，应该在对象字面量中用于分隔键值对":/^\d+$/.test(l)&&(a=`数字 ${l} 不能单独使用，需要赋值给变量或作为表达式的一部分`)}throw new R(a,this.stream.hasMore()?this.stream.consume().getSpan():this.stream.getPrev().getSpan())}return this.parseAccessOrCall(t)}createStringLiteral(e){if(e.getTokenStream()==null)return new O(e.getSpan(),"java.lang.String");let t=this.stream;this.stream=e.getTokenStream();let s=[];for(;this.stream.hasMore();)s.push(this.parseExpression());return this.stream=t,new O(e.getSpan(),"java.lang.String",s)}findBestMatch(e,t){let s=e.expressions().filter(n=>n);for(let n in s){let a=this.findBestMatch(s[n],t);if(a)return a}return e.getSpan().inPosition(t)?e:null}}const Pe=(r,e,t,s)=>{let n=-1,a=d.getImportClass();if(t!==0&&e&&(n=a.length)>0){e=e.toLowerCase(),d.getDefineModules().filter(o=>o.toLowerCase().indexOf(e)>-1).forEach(o=>r.push({label:o,filterText:o,kind:T.CompletionItemKind.Module,detail:o,insertText:o,insertTextRules:T.CompletionItemInsertTextRule.InsertAsSnippet}));let l=new Set;for(let o=0;o<n&&r.length<100;o++){let c=a[o],h=c.toLowerCase().indexOf(e);if(h>-1){let u=c.substring(c.lastIndexOf(".")+1);if(h===0){let E=c.substring(e.length),S=E;if(E.startsWith("."))S=e+".",E=e.substring(e.lastIndexOf(".")+1)+".";else{if(E.indexOf(".")===-1){r.push({sortText:`2${u}`,label:u,kind:T.CompletionItemKind.Class,filterText:c,detail:c,insertText:u,insertTextRules:T.CompletionItemInsertTextRule.InsertAsSnippet});continue}let f=E.substring(0,E.indexOf(".")+1);S=e+f,E=e.substring(e.lastIndexOf(".")+1)+f}if(l.has(E))continue;l.add(E),r.push({sortText:`1${E}`,label:E,kind:T.CompletionItemKind.Folder,filterText:c,detail:S.replace(/\.$/,""),insertText:E,insertTextRules:T.CompletionItemInsertTextRule.InsertAsSnippet,command:{id:"editor.action.triggerSuggest"}})}else u.toLowerCase().indexOf(e)>-1&&r.push({sortText:`2${u}`,label:u,kind:T.CompletionItemKind.Class,filterText:u,detail:c,insertText:c,range:new _(s.lineNumber,t+1,s.lineNumber,s.column)})}}}else d.getDefineModules().forEach(l=>r.push({label:l,filterText:l,kind:T.CompletionItemKind.Module,detail:l,insertText:l,insertTextRules:T.CompletionItemInsertTextRule.InsertAsSnippet}))},Xt=(r,e,t,s)=>{let n=t.indexOf('"')+1;if(n===0&&(n=t.indexOf("'")+1),n===0){t=t.trim().replace("import","").trim(),Pe(r,t,s+1,e);return}let a=t.substring(s).trim().replace(/['|"]/g,"");if(a.startsWith("@")){if(a.indexOf(" ")>-1)return;let l=d.getApiFinder();(l&&l()||[]).forEach(o=>{let c="@"+o.method+":"+o.path;r.push({sortText:c,label:c,kind:T.CompletionItemKind.Reference,filterText:c,detail:o.name,insertText:c,range:new _(e.lineNumber,n+1,e.lineNumber,e.column)})}),l=d.getFunctionFinder(),(l&&l()||[]).forEach(o=>{let c="@"+o.path;r.push({sortText:c,label:c,kind:T.CompletionItemKind.Reference,filterText:c,detail:o.name,insertText:c,range:new _(e.lineNumber,n+1,e.lineNumber,e.column)})});return}Pe(r,a,n,e)},B=async(r,e,t,s,n)=>{if(t=t||{},s&&s instanceof P&&await s.getJavaType(t)==="java.lang.Object"){let h=d.getImportClass();const u=s.variable;h.forEach(E=>{let S=E.substring(E.lastIndexOf(".")+1);S.indexOf(u)>-1&&r.push({sortText:`${S}`,label:S,kind:T.CompletionItemKind.Class,filterText:S,detail:E,insertTextRules:T.CompletionItemInsertTextRule.InsertAsSnippet,command:{id:"editor.action.scrollUp1Line"},insertText:S+(n?"()":""),additionalTextEdits:[{forceMoveMarkers:!0,text:`import ${E}\r
`,range:new _(1,0,1,0)}]})})}d.findFunction().forEach(h=>{r.push({sortText:h.sortText||h.fullName,label:h.fullName,filterText:h.name,kind:T.CompletionItemKind.Method,detail:h.comment,insertText:h.insertText,insertTextRules:T.CompletionItemInsertTextRule.InsertAsSnippet})});let a=r.map(h=>h.detail),l=e.match(/[a-zA-Z_$]+/gi)||[],o=l.length,c=Object.keys(t);c.forEach(h=>{r.push({label:h,filterText:h,kind:T.CompletionItemKind.Variable,detail:t[h],insertText:h,insertTextRules:T.CompletionItemInsertTextRule.InsertAsSnippet})}),o>2&&Array.from(new Set(l)).filter((h,u)=>u+2<o&&a.indexOf(h)===-1&&c.indexOf(h)===-1).map(h=>{r.push({label:h,filterText:h,kind:T.CompletionItemKind.Text,detail:h,insertText:h,insertTextRules:T.CompletionItemInsertTextRule.InsertAsSnippet})})},De=async(r,e)=>{let t=await d.loadClass(r),s=r.lastIndexOf("."),n=s>0?r.substring(s+1):r,a=d.findEnums(t);if(a)for(let c=0;c<a.length;c++){let h=a[c];e.push({label:h,kind:T.CompletionItemKind.Enum,detail:h+":"+h,insertText:h,sortText:" ~~~"+h})}let l=d.findAttributes(t);if(l)for(let c=0;c<l.length;c++){let h=l[c];e.push({label:h.name,kind:T.CompletionItemKind.Field,detail:h.comment||h.type+":"+h.name,insertText:h.name,sortText:" ~~"+h.name})}let o=d.findMethods(t);if(o){let c={};for(let h=0;h<o.length;h++){let u=o[h];if(c[u.signature])continue;c[u.signature]=!0;let E=[];u.comment&&E.push(u.comment);for(let S=u.extension?1:0;S<u.parameters.length;S++){let f=u.parameters[S];E.push(`\`${f.name}\`：${f.comment||f.type}`)}E.push(`返回类型：\`${u.returnType}\``),e.push({sortText:u.sortText||u.fullName,label:u.fullName,kind:T.CompletionItemKind.Method,detail:`${n}.${u.fullName}: ${u.returnType}`,documentation:{value:E.join(`\r
\r
\r
`)},insertText:u.insertText,insertTextRules:T.CompletionItemInsertTextRule.InsertAsSnippet})}}};async function Jt(r,e){try{let t=q(e);if(t.length===0){await B(r,e);return}let n=new W(new U(t));const{best:a,env:l}=await n.parseBest(e.length-1);return e.endsWith(".")?await De(await a.getJavaType(l),r):a?a instanceof M||a instanceof K?await De(await a.target.getJavaType(l),r):a instanceof k&&a.identifier instanceof P?await B(r,e,l,a.identifier,!0):await B(r,e,l,a):await B(r,e,l),r}catch{}}const Qt=[["var","var ","var"],["let","let ","let"],["const","const ","const"],["instanceof","instanceof ","instanceof"],["try",`try {\r
	\${1}\r
} catch (\${2:e}) {\r
	\${3}\r
}`,"try catch"],["try catch finally",`try {\r
	\${1}\r
} catch (\${2:e}) {\r
	\${3}\r
} finally {\r
	\${4}\r
}`,"try catch finally"],["foreach","${1:list}.each(${2:item => {\r\n	${3}\r\n}})","循环集合"],["for","for (${1:item} in ${2:collection}) {\r\n	${3}\r\n}","循环集合"],["assert","assert ${1:condition} : ${2:code}, ${3:message}","校验参数"],["break","break;","跳出循环"],["continue","continue;","继续循环"],["import","import $1","导入"],["return","return $1","返回"],["if",`if (\${1:condition}){\r
	$2\r
}`,"判断"],["ife",`if (\${1:condition}) {\r
	$2\r
} else { \r
	$3\r
}`,"判断"],["exit","exit ${1:code}, ${2:message};","退出"],["logi","log.info($1);","info日志"],["logd","log.debug($1);","debug日志"],["loge","log.error($1);","error日志"],["logw","log.warn($1);","warn日志"]],Zt={provideCompletionItems:async function(r,e){let t=r.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:e.lineNumber,endColumn:e.column}),s=r.getValueInRange({startLineNumber:e.lineNumber,startColumn:1,endLineNumber:e.lineNumber,endColumn:e.column}),n=r.getWordUntilPosition(e),a={startLineNumber:e.lineNumber,endLineNumber:e.lineNumber,startColumn:n.startColumn,endColumn:n.endColumn},l=!1,o=Qt.map((c,h)=>({label:c[0],kind:T.CompletionItemKind.Struct,detail:c[2]||c[1],insertText:c[1],filterText:c[0],insertTextRules:T.CompletionItemInsertTextRule.InsertAsSnippet,range:a}));if(s.length>1&&s.trim().indexOf("import")===0)o=[],Xt(o,e,s,s.indexOf("import")+6),l=!0;else if(s.endsWith("::"))o=["int","long","date","string","short","byte","float","double","json","stringify","sql"].map(c=>({label:c,detail:`转换为${c==="stringify"?"json字符串":c==="sql"?"sql参数类型":c}`,insertText:c,kind:T.CompletionItemKind.TypeParameter,insertTextRules:T.CompletionItemInsertTextRule.InsertAsSnippet}));else if(t.length>1)s.endsWith(".")&&(o=[]),await Jt(o,t);else{const c=de.environmentFunction();await B(o,t,{...c&&typeof c=="object"?c:{},...d.getAutoImportClass(),...d.getAutoImportModule()})}return{suggestions:o,incomplete:l}},triggerCharacters:[".",":"]},zt={provideDefinition(r,e){const t=r.getWordAtPosition(e);if(!t)return null;const s=t.word,n=r.getLineCount(),a=[];for(let l=1;l<=n;l++){const o=r.getLineContent(l),c=o.match(/^import\s+([a-zA-Z0-9_.]+)\s*;/);if(c){const p=c[1].split(".").pop();if(p===s){const I=o.lastIndexOf(p);a.push({uri:r.uri,range:new _(l,I+1,l,I+p.length+1)})}}const h=o.match(/\bas\s+(\w+)/);if(h&&h[1]===s){const A=h[1],p=o.indexOf(A);a.push({uri:r.uri,range:new _(l,p+1,l,p+A.length+1)})}const u=o.match(/^import\s+(\w+)\s*;/);if(u&&u[1]===s){const A=u[1],p=o.indexOf(A);a.push({uri:r.uri,range:new _(l,p+1,l,p+A.length+1)})}const E=o.match(/^(const|let|var|Object|Long|String|Double|Float|Integer|Byte|Pattern|BigDecimal|Boolean)\s+(\w+)/);if(E&&E[2]===s){const A=E[2],p=o.indexOf(A);a.push({uri:r.uri,range:new _(l,p+1,l,p+A.length+1)})}const S=o.match(/^function\s+(\w+)\s*\(([^)]*)\)/)||o.match(/^const\s+(\w+)\s*=\s*\(([^)]*)\)\s*=>/);if(S){if(S[1]===s){const p=S[1],I=o.indexOf(p);a.push({uri:r.uri,range:new _(l,I+1,l,I+p.length+1)})}S[2].split(",").map(p=>p.trim()).forEach(p=>{if(p===s){const I=o.indexOf(p);a.push({uri:r.uri,range:new _(l,I+1,l,I+p.length+1)})}})}const f=o.match(/^for\s*\(\s*(\w+)\s+in\s+/);if(f&&f[1]===s){const A=f[1],p=o.indexOf(A);a.push({uri:r.uri,range:new _(l,p+1,l,p+A.length+1)})}}return a.length?a:null}},er={provideReferences:function(r,e){const t=r.getWordAtPosition(e);if(!t)return[];const s=t.word,n=[],a=r.getLineCount();for(let l=1;l<=a;l++){const o=r.getLineContent(l);let c=0;const h=new RegExp(`\\b${s}\\b`,"g");let u;for(;(u=h.exec(o))!==null;)c=u.index,n.push({uri:r.uri,range:new _(l,c+1,l,c+s.length+1)})}return n}},pe=(r,e,t)=>{t.push({value:`${r}${e.fullName}`}),e.comment&&t.push({value:`${e.comment}`}),e.parameters.forEach((s,n)=>{(n>0||!e.extension)&&t.push({value:`${s.name}：${s.comment||s.type}`})}),t.push({value:`返回类型：\`${e.returnType}\``})},Z=(r,e,t,s)=>{let n=d.findFunction().filter(a=>a.name===r);if(n.length>0)pe("",n[0],t);else{let a=e[r];if(a&&a.indexOf("@")===0){let l=a.substring(1),o=d.getOnlineFunction(l);if(o){let c=Array.isArray(o.parameter)?o.parameter:JSON.parse(o.parameter||"[]");c.forEach(h=>h.comment=h.description),pe("",{fullName:r+" "+o.name,comment:o.description||"",parameters:c,returnType:o.returnType},t)}}else t.push({value:`${s?"创建对象":"访问变量"}：${r}`}),t.push({value:`类型：${a||"unknow"}`})}},tr={provideHover:async(r,e)=>{let t=r.getValue(),s=q(t),n=new U(s),a=new W(n),l=a.parse(!0);const c=r.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:e.lineNumber,endColumn:e.column}).length;for(let h=0,u=l.length;h<u;h++){const E=a.findBestMatch(l[h],c);if(E){const S=await a.processEnv(l),f=[];let A=E.getSpan().getLine();if(E instanceof Ye){const p=E.tokens;if(E.isObjectDestructuring()){f.push({value:"对象解构赋值"});for(const I of p){const x=I.getText(),N=S[x];f.push({value:`变量 ${x}: ${N}`})}}else f.push({value:"数组解构赋值"})}else if(E instanceof G){const p=S[E.getVarName()];f.push({value:`定义变量：${E.getVarName()}`}),f.push({value:`变量类型：${p}`})}else if(E instanceof Ge)if(E.convert==="json")f.push({value:"强制转换为`JSON`类型"});else if(E.convert==="stringify")f.push({value:"转换为`JSON`字符串"});else if(E.convert==="sql"){const p=E.args||[];f.push({value:`等同于\`new SqlParameterValue(java.sql.Types.${p[0]?.span?.getText()?.toUpperCase()},${E.target.getSpan().getText()})\``})}else f.push({value:`转换为\`${E.convert}\``});else if(E instanceof P){const p=S[E.getVariable()];p?(f.push({value:`访问变量：${E.getVariable()}`}),f.push({value:`变量类型：${p||"unknow"}`})):Z(E.getVariable(),S,f)}else if(E instanceof M){const p=await E.getTarget().getJavaType(S),I=await d.loadClass(p),x=E.member.getText();d.findMethods(I).filter(N=>N.name===x).forEach(N=>pe(`${d.getSimpleClass(p)}.`,N,f)),d.findEnums(I).filter(N=>N===x).forEach(N=>{f.push({value:`访问枚举：\`${p}.${x}\``})}),d.findAttributes(I).filter(N=>N.name===x).forEach(N=>{f.push({value:`访问属性：\`${p}.${x}\``}),N.comment&&f.push({value:`${N.comment}`}),f.push({value:`属性类型：\`${N.type}\``})}),A=E.member.getLine()}else if(E instanceof Ee){const p=E.target;Z(p.variable,S,f)}else if(E instanceof k){const p=E.identifier;p instanceof P&&Z(p,S,f,!0)}else if(E instanceof H)f.push({value:"访问Map或数组"});else if(E instanceof Ve)f.push({value:"linq查询"});else return;return{range:new Range(A.lineNumber,A.startCol,A.endLineNumber,A.endCol+1),contents:f}}}}},rr={signatureHelpRetriggerCharacters:["(",","],signatureHelpTriggerCharacters:["(",","],provideSignatureHelp:async(r,e,t,s)=>{if(s.activeSignatureHelp){let a=s.activeSignatureHelp;return a.activeSignature+=1,a.activeSignature===a.signatures.length&&(a.activeSignature=0),{dispose:function(){},value:a}}let n=r.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:e.lineNumber,endColumn:e.column});try{let a=q(n),l=new W(new U(a));const{best:o,env:c}=await l.parseBest(n.length-1);if(o&&o instanceof K){let h=o.target,u=await h.getTarget().getJavaType(c),E=h.member.getText(),S=d.findMethods(await d.loadClass(u)),f=[];if(S.filter(A=>A.name===E).forEach(A=>{let p=[];for(let I=A.extension?1:0;I<A.parameters.length;I++){let x=A.parameters[I];p.push("- "+x.name+"："+(x.comment||x.type))}f.push({label:A.fullName,documentation:{value:A.comment},parameters:[{label:"param1",documentation:{value:p.join(`\r
`)}}]})}),f.length>0)return{dispose:function(){},value:{activeParameter:0,activeSignature:0,signatures:f}}}}catch{}}};let He=function(r,e){for(var t=0,s=0,n=r.length;s<n;){var a=r.charCodeAt(s);if(a===32)t++;else if(a===9)t=t-t%e+e;else break;s++}return s===n?-1:t};class sr{constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,s){if(!(e>16777215||t>16777215)){var n=this._length;this._startIndexes[n]=e,this._endIndexes[n]=t,this._length++,s<1e3&&(this._indentOccurrences[s]=(this._indentOccurrences[s]||0)+1)}}toIndentRanges(e){var t=[];if(this._length<=this._foldingRangesLimit){new Uint32Array(this._length),new Uint32Array(this._length);for(var s=this._length-1,n=0;s>=0;s--,n++)t.push({start:this._startIndexes[s],end:this._endIndexes[s]})}else{for(var a=0,l=this._indentOccurrences.length,s=0;s<this._indentOccurrences.length;s++){var o=this._indentOccurrences[s];if(o){if(o+a>this._foldingRangesLimit){l=s;break}a+=o}}var c=e.getOptions().tabSize;new Uint32Array(this._foldingRangesLimit),new Uint32Array(this._foldingRangesLimit);for(var s=this._length-1,n=0;s>=0;s--){var h=this._startIndexes[s],u=e.getLineContent(h),E=He(u,c);(E<l||E===l&&a++<this._foldingRangesLimit)&&(t.push({start:h,end:this._endIndexes[s]}),n++)}}return t}}const nr={provideFoldingRanges:(r,e)=>{let t=r.getOptions().tabSize,s=new sr(5e3),n=[],a=r.getLineCount()+1,l=-1,o=-1,c=[];n.push({indent:-1,endAbove:a,line:a});for(let u=r.getLineCount();u>0;u--){let E=r.getLineContent(u);E.startsWith("import")||E.trim().startsWith("import")?l==-1?l=u:o=u:(o>-1&&l>-1&&c.push({start:o,end:l,kind:T.FoldingRangeKind.Imports}),o=-1,l=-1);let S=He(E,t),f=n[n.length-1];if(S!==-1){if(f.indent>S){do n.pop(),f=n[n.length-1];while(f.indent>S);var h=f.endAbove-1;h-u>=1&&s.insertFirst(u,h,S)}f.indent===S?f.endAbove=u:n.push({indent:S,endAbove:u,line:u})}}return o>-1&&l>-1&&c.push({start:o,end:l,kind:T.FoldingRangeKind.Imports}),c.concat(s.toIndentRanges(r))}},ir=()=>{const r="mybatis";T.register({id:r}),T.setLanguageConfiguration(r,{comments:{lineComment:"--",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}]}),T.setMonarchTokensProvider(r,{defaultToken:"",tokenPostfix:".sql",ignoreCase:!0,brackets:[{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"}],keywords:["ABORT_AFTER_WAIT","ABSENT","ABSOLUTE","ACCENT_SENSITIVITY","ACTION","ACTIVATION","ACTIVE","ADD","ADDRESS","ADMIN","AES","AES_128","AES_192","AES_256","AFFINITY","AFTER","AGGREGATE","ALGORITHM","ALL_CONSTRAINTS","ALL_ERRORMSGS","ALL_INDEXES","ALL_LEVELS","ALL_SPARSE_COLUMNS","ALLOW_CONNECTIONS","ALLOW_MULTIPLE_EVENT_LOSS","ALLOW_PAGE_LOCKS","ALLOW_ROW_LOCKS","ALLOW_SINGLE_EVENT_LOSS","ALLOW_SNAPSHOT_ISOLATION","ALLOWED","ALTER","ANONYMOUS","ANSI_DEFAULTS","ANSI_NULL_DEFAULT","ANSI_NULL_DFLT_OFF","ANSI_NULL_DFLT_ON","ANSI_NULLS","ANSI_PADDING","ANSI_WARNINGS","APPEND","APPLICATION","APPLICATION_LOG","ARITHABORT","ARITHIGNORE","AS","ASC","ASSEMBLY","ASYMMETRIC","ASYNCHRONOUS_COMMIT","AT","ATOMIC","ATTACH","ATTACH_REBUILD_LOG","AUDIT","AUDIT_GUID","AUTHENTICATION","AUTHORIZATION","AUTO","AUTO_CLEANUP","AUTO_CLOSE","AUTO_CREATE_STATISTICS","AUTO_SHRINK","AUTO_UPDATE_STATISTICS","AUTO_UPDATE_STATISTICS_ASYNC","AUTOMATED_BACKUP_PREFERENCE","AUTOMATIC","AVAILABILITY","AVAILABILITY_MODE","BACKUP","BACKUP_PRIORITY","BASE64","BATCHSIZE","BEGIN","BEGIN_DIALOG","BIGINT","BINARY","BINDING","BIT","BLOCKERS","BLOCKSIZE","BOUNDING_BOX","BREAK","BROKER","BROKER_INSTANCE","BROWSE","BUCKET_COUNT","BUFFER","BUFFERCOUNT","BULK","BULK_LOGGED","BY","CACHE","CALL","CALLED","CALLER","CAP_CPU_PERCENT","CASCADE","CASE","CATALOG","CATCH","CELLS_PER_OBJECT","CERTIFICATE","CHANGE_RETENTION","CHANGE_TRACKING","CHANGES","CHAR","CHARACTER","CHECK","CHECK_CONSTRAINTS","CHECK_EXPIRATION","CHECK_POLICY","CHECKALLOC","CHECKCATALOG","CHECKCONSTRAINTS","CHECKDB","CHECKFILEGROUP","CHECKIDENT","CHECKPOINT","CHECKTABLE","CLASSIFIER_FUNCTION","CLEANTABLE","CLEANUP","CLEAR","CLOSE","CLUSTER","CLUSTERED","CODEPAGE","COLLATE","COLLECTION","COLUMN","COLUMN_SET","COLUMNS","COLUMNSTORE","COLUMNSTORE_ARCHIVE","COMMIT","COMMITTED","COMPATIBILITY_LEVEL","COMPRESSION","COMPUTE","CONCAT","CONCAT_NULL_YIELDS_NULL","CONFIGURATION","CONNECT","CONSTRAINT","CONTAINMENT","CONTENT","CONTEXT","CONTINUE","CONTINUE_AFTER_ERROR","CONTRACT","CONTRACT_NAME","CONTROL","CONVERSATION","COOKIE","COPY_ONLY","COUNTER","CPU","CREATE","CREATE_NEW","CREATION_DISPOSITION","CREDENTIAL","CRYPTOGRAPHIC","CUBE","CURRENT","CURRENT_DATE","CURSOR","CURSOR_CLOSE_ON_COMMIT","CURSOR_DEFAULT","CYCLE","DATA","DATA_COMPRESSION","DATA_PURITY","DATABASE","DATABASE_DEFAULT","DATABASE_MIRRORING","DATABASE_SNAPSHOT","DATAFILETYPE","DATE","DATE_CORRELATION_OPTIMIZATION","DATEFIRST","DATEFORMAT","DATETIME","DATETIME2","DATETIMEOFFSET","DAY","DAYOFYEAR","DAYS","DB_CHAINING","DBCC","DBREINDEX","DDL_DATABASE_LEVEL_EVENTS","DEADLOCK_PRIORITY","DEALLOCATE","DEC","DECIMAL","DECLARE","DECRYPTION","DEFAULT","DEFAULT_DATABASE","DEFAULT_FULLTEXT_LANGUAGE","DEFAULT_LANGUAGE","DEFAULT_SCHEMA","DEFINITION","DELAY","DELAYED_DURABILITY","DELETE","DELETED","DENSITY_VECTOR","DENY","DEPENDENTS","DES","DESC","DESCRIPTION","DESX","DHCP","DIAGNOSTICS","DIALOG","DIFFERENTIAL","DIRECTORY_NAME","DISABLE","DISABLE_BROKER","DISABLED","DISK","DISTINCT","DISTRIBUTED","DOCUMENT","DOUBLE","DROP","DROP_EXISTING","DROPCLEANBUFFERS","DUMP","DURABILITY","DYNAMIC","EDITION","ELEMENTS","ELSE","EMERGENCY","EMPTY","EMPTYFILE","ENABLE","ENABLE_BROKER","ENABLED","ENCRYPTION","END","ENDPOINT","ENDPOINT_URL","ERRLVL","ERROR","ERROR_BROKER_CONVERSATIONS","ERRORFILE","ESCAPE","ESTIMATEONLY","EVENT","EVENT_RETENTION_MODE","EXEC","EXECUTABLE","EXECUTE","EXIT","EXPAND","EXPIREDATE","EXPIRY_DATE","EXPLICIT","EXTENDED_LOGICAL_CHECKS","EXTENSION","EXTERNAL","EXTERNAL_ACCESS","FAIL_OPERATION","FAILOVER","FAILOVER_MODE","FAILURE_CONDITION_LEVEL","FALSE","FAN_IN","FAST","FAST_FORWARD","FETCH","FIELDTERMINATOR","FILE","FILEGROUP","FILEGROWTH","FILELISTONLY","FILENAME","FILEPATH","FILESTREAM","FILESTREAM_ON","FILETABLE_COLLATE_FILENAME","FILETABLE_DIRECTORY","FILETABLE_FULLPATH_UNIQUE_CONSTRAINT_NAME","FILETABLE_NAMESPACE","FILETABLE_PRIMARY_KEY_CONSTRAINT_NAME","FILETABLE_STREAMID_UNIQUE_CONSTRAINT_NAME","FILLFACTOR","FILTERING","FIRE_TRIGGERS","FIRST","FIRSTROW","FLOAT","FMTONLY","FOLLOWING","FOR","FORCE","FORCE_FAILOVER_ALLOW_DATA_LOSS","FORCE_SERVICE_ALLOW_DATA_LOSS","FORCED","FORCEPLAN","FORCESCAN","FORCESEEK","FOREIGN","FORMATFILE","FORMSOF","FORWARD_ONLY","FREE","FREEPROCCACHE","FREESESSIONCACHE","FREESYSTEMCACHE","FROM","FULL","FULLSCAN","FULLTEXT","FUNCTION","GB","GEOGRAPHY_AUTO_GRID","GEOGRAPHY_GRID","GEOMETRY_AUTO_GRID","GEOMETRY_GRID","GET","GLOBAL","GO","GOTO","GOVERNOR","GRANT","GRIDS","GROUP","GROUP_MAX_REQUESTS","HADR","HASH","HASHED","HAVING","HEADERONLY","HEALTH_CHECK_TIMEOUT","HELP","HIERARCHYID","HIGH","HINT","HISTOGRAM","HOLDLOCK","HONOR_BROKER_PRIORITY","HOUR","HOURS","IDENTITY","IDENTITY_INSERT","IDENTITY_VALUE","IDENTITYCOL","IF","IGNORE_CONSTRAINTS","IGNORE_DUP_KEY","IGNORE_NONCLUSTERED_COLUMNSTORE_INDEX","IGNORE_TRIGGERS","IMAGE","IMMEDIATE","IMPERSONATE","IMPLICIT_TRANSACTIONS","IMPORTANCE","INCLUDE","INCREMENT","INCREMENTAL","INDEX","INDEXDEFRAG","INFINITE","INFLECTIONAL","INIT","INITIATOR","INPUT","INPUTBUFFER","INSENSITIVE","INSERT","INSERTED","INSTEAD","INT","INTEGER","INTO","IO","IP","ISABOUT","ISOLATION","JOB","KB","KEEP","KEEP_CDC","KEEP_NULLS","KEEP_REPLICATION","KEEPDEFAULTS","KEEPFIXED","KEEPIDENTITY","KEEPNULLS","KERBEROS","KEY","KEY_SOURCE","KEYS","KEYSET","KILL","KILOBYTES_PER_BATCH","LABELONLY","LANGUAGE","LAST","LASTROW","LEVEL","LEVEL_1","LEVEL_2","LEVEL_3","LEVEL_4","LIFETIME","LIMIT","LINENO","LIST","LISTENER","LISTENER_IP","LISTENER_PORT","LOAD","LOADHISTORY","LOB_COMPACTION","LOCAL","LOCAL_SERVICE_NAME","LOCK_ESCALATION","LOCK_TIMEOUT","LOGIN","LOGSPACE","LOOP","LOW","MANUAL","MARK","MARK_IN_USE_FOR_REMOVAL","MASTER","MAX_CPU_PERCENT","MAX_DISPATCH_LATENCY","MAX_DOP","MAX_DURATION","MAX_EVENT_SIZE","MAX_FILES","MAX_IOPS_PER_VOLUME","MAX_MEMORY","MAX_MEMORY_PERCENT","MAX_QUEUE_READERS","MAX_ROLLOVER_FILES","MAX_SIZE","MAXDOP","MAXERRORS","MAXLENGTH","MAXRECURSION","MAXSIZE","MAXTRANSFERSIZE","MAXVALUE","MB","MEDIADESCRIPTION","MEDIANAME","MEDIAPASSWORD","MEDIUM","MEMBER","MEMORY_OPTIMIZED","MEMORY_OPTIMIZED_DATA","MEMORY_OPTIMIZED_ELEVATE_TO_SNAPSHOT","MEMORY_PARTITION_MODE","MERGE","MESSAGE","MESSAGE_FORWARD_SIZE","MESSAGE_FORWARDING","MICROSECOND","MILLISECOND","MIN_CPU_PERCENT","MIN_IOPS_PER_VOLUME","MIN_MEMORY_PERCENT","MINUTE","MINUTES","MINVALUE","MIRROR","MIRROR_ADDRESS","MODIFY","MONEY","MONTH","MOVE","MULTI_USER","MUST_CHANGE","NAME","NANOSECOND","NATIONAL","NATIVE_COMPILATION","NCHAR","NEGOTIATE","NESTED_TRIGGERS","NEW_ACCOUNT","NEW_BROKER","NEW_PASSWORD","NEWNAME","NEXT","NO","NO_BROWSETABLE","NO_CHECKSUM","NO_COMPRESSION","NO_EVENT_LOSS","NO_INFOMSGS","NO_TRUNCATE","NO_WAIT","NOCHECK","NOCOUNT","NOEXEC","NOEXPAND","NOFORMAT","NOINDEX","NOINIT","NOLOCK","NON","NON_TRANSACTED_ACCESS","NONCLUSTERED","NONE","NORECOMPUTE","NORECOVERY","NORESEED","NORESET","NOREWIND","NORMAL","NOSKIP","NOTIFICATION","NOTRUNCATE","NOUNLOAD","NOWAIT","NTEXT","NTLM","NUMANODE","NUMERIC","NUMERIC_ROUNDABORT","NVARCHAR","OBJECT","OF","OFF","OFFLINE","OFFSET","OFFSETS","OLD_ACCOUNT","OLD_PASSWORD","ON","ON_FAILURE","ONLINE","ONLY","OPEN","OPEN_EXISTING","OPENTRAN","OPTIMISTIC","OPTIMIZE","OPTION","ORDER","OUT","OUTPUT","OUTPUTBUFFER","OVER","OVERRIDE","OWNER","OWNERSHIP","PAD_INDEX","PAGE","PAGE_VERIFY","PAGECOUNT","PAGLOCK","PARAMETERIZATION","PARSEONLY","PARTIAL","PARTITION","PARTITIONS","PARTNER","PASSWORD","PATH","PER_CPU","PER_NODE","PERCENT","PERMISSION_SET","PERSISTED","PHYSICAL_ONLY","PLAN","POISON_MESSAGE_HANDLING","POOL","POPULATION","PORT","PRECEDING","PRECISION","PRIMARY","PRIMARY_ROLE","PRINT","PRIOR","PRIORITY","PRIORITY_LEVEL","PRIVATE","PRIVILEGES","PROC","PROCCACHE","PROCEDURE","PROCEDURE_NAME","PROCESS","PROFILE","PROPERTY","PROPERTY_DESCRIPTION","PROPERTY_INT_ID","PROPERTY_SET_GUID","PROVIDER","PROVIDER_KEY_NAME","PUBLIC","PUT","QUARTER","QUERY","QUERY_GOVERNOR_COST_LIMIT","QUEUE","QUEUE_DELAY","QUOTED_IDENTIFIER","RAISERROR","RANGE","RAW","RC2","RC4","RC4_128","READ","READ_COMMITTED_SNAPSHOT","READ_ONLY","READ_ONLY_ROUTING_LIST","READ_ONLY_ROUTING_URL","READ_WRITE","READ_WRITE_FILEGROUPS","READCOMMITTED","READCOMMITTEDLOCK","READONLY","READPAST","READTEXT","READUNCOMMITTED","READWRITE","REAL","REBUILD","RECEIVE","RECOMPILE","RECONFIGURE","RECOVERY","RECURSIVE","RECURSIVE_TRIGGERS","REFERENCES","REGENERATE","RELATED_CONVERSATION","RELATED_CONVERSATION_GROUP","RELATIVE","REMOTE","REMOTE_PROC_TRANSACTIONS","REMOTE_SERVICE_NAME","REMOVE","REORGANIZE","REPAIR_ALLOW_DATA_LOSS","REPAIR_FAST","REPAIR_REBUILD","REPEATABLE","REPEATABLEREAD","REPLICA","REPLICATION","REQUEST_MAX_CPU_TIME_SEC","REQUEST_MAX_MEMORY_GRANT_PERCENT","REQUEST_MEMORY_GRANT_TIMEOUT_SEC","REQUIRED","RESAMPLE","RESEED","RESERVE_DISK_SPACE","RESET","RESOURCE","RESTART","RESTORE","RESTRICT","RESTRICTED_USER","RESULT","RESUME","RETAINDAYS","RETENTION","RETURN","RETURNS","REVERT","REVOKE","REWIND","REWINDONLY","ROBUST","ROLE","ROLLBACK","ROLLUP","ROOT","ROUTE","ROW","ROWCOUNT","ROWGUIDCOL","ROWLOCK","ROWS","ROWS_PER_BATCH","ROWTERMINATOR","ROWVERSION","RSA_1024","RSA_2048","RSA_512","RULE","SAFE","SAFETY","SAMPLE","SAVE","SCHEDULER","SCHEMA","SCHEMA_AND_DATA","SCHEMA_ONLY","SCHEMABINDING","SCHEME","SCROLL","SCROLL_LOCKS","SEARCH","SECOND","SECONDARY","SECONDARY_ONLY","SECONDARY_ROLE","SECONDS","SECRET","SECURITY_LOG","SECURITYAUDIT","SELECT","SELECTIVE","SELF","SEND","SENT","SEQUENCE","SERIALIZABLE","SERVER","SERVICE","SERVICE_BROKER","SERVICE_NAME","SESSION","SESSION_TIMEOUT","SET","SETS","SETUSER","SHOW_STATISTICS","SHOWCONTIG","SHOWPLAN","SHOWPLAN_ALL","SHOWPLAN_TEXT","SHOWPLAN_XML","SHRINKDATABASE","SHRINKFILE","SHUTDOWN","SID","SIGNATURE","SIMPLE","SINGLE_BLOB","SINGLE_CLOB","SINGLE_NCLOB","SINGLE_USER","SINGLETON","SIZE","SKIP","SMALLDATETIME","SMALLINT","SMALLMONEY","SNAPSHOT","SORT_IN_TEMPDB","SOURCE","SPARSE","SPATIAL","SPATIAL_WINDOW_MAX_CELLS","SPECIFICATION","SPLIT","SQL","SQL_VARIANT","SQLPERF","STANDBY","START","START_DATE","STARTED","STARTUP_STATE","STAT_HEADER","STATE","STATEMENT","STATIC","STATISTICAL_SEMANTICS","STATISTICS","STATISTICS_INCREMENTAL","STATISTICS_NORECOMPUTE","STATS","STATS_STREAM","STATUS","STATUSONLY","STOP","STOP_ON_ERROR","STOPAT","STOPATMARK","STOPBEFOREMARK","STOPLIST","STOPPED","SUBJECT","SUBSCRIPTION","SUPPORTED","SUSPEND","SWITCH","SYMMETRIC","SYNCHRONOUS_COMMIT","SYNONYM","SYSNAME","SYSTEM","TABLE","TABLERESULTS","TABLESAMPLE","TABLOCK","TABLOCKX","TAKE","TAPE","TARGET","TARGET_RECOVERY_TIME","TB","TCP","TEXT","TEXTIMAGE_ON","TEXTSIZE","THEN","THESAURUS","THROW","TIES","TIME","TIMEOUT","TIMER","TIMESTAMP","TINYINT","TO","TOP","TORN_PAGE_DETECTION","TRACEOFF","TRACEON","TRACESTATUS","TRACK_CAUSALITY","TRACK_COLUMNS_UPDATED","TRAN","TRANSACTION","TRANSFER","TRANSFORM_NOISE_WORDS","TRIGGER","TRIPLE_DES","TRIPLE_DES_3KEY","TRUE","TRUNCATE","TRUNCATEONLY","TRUSTWORTHY","TRY","TSQL","TWO_DIGIT_YEAR_CUTOFF","TYPE","TYPE_WARNING","UNBOUNDED","UNCHECKED","UNCOMMITTED","UNDEFINED","UNIQUE","UNIQUEIDENTIFIER","UNKNOWN","UNLIMITED","UNLOAD","UNSAFE","UPDATE","UPDATETEXT","UPDATEUSAGE","UPDLOCK","URL","USE","USED","USER","USEROPTIONS","USING","VALID_XML","VALIDATION","VALUE","VALUES","VARBINARY","VARCHAR","VARYING","VERIFYONLY","VERSION","VIEW","VIEW_METADATA","VIEWS","VISIBILITY","WAIT_AT_LOW_PRIORITY","WAITFOR","WEEK","WEIGHT","WELL_FORMED_XML","WHEN","WHERE","WHILE","WINDOWS","WITH","WITHIN","WITHOUT","WITNESS","WORK","WORKLOAD","WRITETEXT","XACT_ABORT","XLOCK","XMAX","XMIN","XML","XMLDATA","XMLNAMESPACES","XMLSCHEMA","XQUERY","XSINIL","YEAR","YMAX","YMIN"],operators:["ALL","AND","ANY","BETWEEN","EXISTS","IN","LIKE","NOT","OR","SOME","EXCEPT","INTERSECT","UNION","APPLY","CROSS","FULL","INNER","JOIN","LEFT","OUTER","RIGHT","CONTAINS","FREETEXT","IS","NULL","PIVOT","UNPIVOT","MATCHED"],builtinFunctions:["AVG","CHECKSUM_AGG","COUNT","COUNT_BIG","GROUPING","GROUPING_ID","MAX","MIN","SUM","STDEV","STDEVP","VAR","VARP","CUME_DIST","FIRST_VALUE","LAG","LAST_VALUE","LEAD","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","COLLATE","COLLATIONPROPERTY","TERTIARY_WEIGHTS","FEDERATION_FILTERING_VALUE","CAST","CONVERT","PARSE","TRY_CAST","TRY_CONVERT","TRY_PARSE","ASYMKEY_ID","ASYMKEYPROPERTY","CERTPROPERTY","CERT_ID","CRYPT_GEN_RANDOM","DECRYPTBYASYMKEY","DECRYPTBYCERT","DECRYPTBYKEY","DECRYPTBYKEYAUTOASYMKEY","DECRYPTBYKEYAUTOCERT","DECRYPTBYPASSPHRASE","ENCRYPTBYASYMKEY","ENCRYPTBYCERT","ENCRYPTBYKEY","ENCRYPTBYPASSPHRASE","HASHBYTES","IS_OBJECTSIGNED","KEY_GUID","KEY_ID","KEY_NAME","SIGNBYASYMKEY","SIGNBYCERT","SYMKEYPROPERTY","VERIFYSIGNEDBYCERT","VERIFYSIGNEDBYASYMKEY","CURSOR_STATUS","DATALENGTH","IDENT_CURRENT","IDENT_INCR","IDENT_SEED","IDENTITY","SQL_VARIANT_PROPERTY","CURRENT_TIMESTAMP","DATEADD","DATEDIFF","DATEFROMPARTS","DATENAME","DATEPART","DATETIME2FROMPARTS","DATETIMEFROMPARTS","DATETIMEOFFSETFROMPARTS","DAY","EOMONTH","GETDATE","GETUTCDATE","ISDATE","MONTH","SMALLDATETIMEFROMPARTS","SWITCHOFFSET","SYSDATETIME","SYSDATETIMEOFFSET","SYSUTCDATETIME","TIMEFROMPARTS","TODATETIMEOFFSET","YEAR","CHOOSE","COALESCE","IIF","NULLIF","ABS","ACOS","ASIN","ATAN","ATN2","CEILING","COS","COT","DEGREES","EXP","FLOOR","LOG","LOG10","PI","POWER","RADIANS","RAND","ROUND","SIGN","SIN","SQRT","SQUARE","TAN","APP_NAME","APPLOCK_MODE","APPLOCK_TEST","ASSEMBLYPROPERTY","COL_LENGTH","COL_NAME","COLUMNPROPERTY","DATABASE_PRINCIPAL_ID","DATABASEPROPERTYEX","DB_ID","DB_NAME","FILE_ID","FILE_IDEX","FILE_NAME","FILEGROUP_ID","FILEGROUP_NAME","FILEGROUPPROPERTY","FILEPROPERTY","FULLTEXTCATALOGPROPERTY","FULLTEXTSERVICEPROPERTY","INDEX_COL","INDEXKEY_PROPERTY","INDEXPROPERTY","OBJECT_DEFINITION","OBJECT_ID","OBJECT_NAME","OBJECT_SCHEMA_NAME","OBJECTPROPERTY","OBJECTPROPERTYEX","ORIGINAL_DB_NAME","PARSENAME","SCHEMA_ID","SCHEMA_NAME","SCOPE_IDENTITY","SERVERPROPERTY","STATS_DATE","TYPE_ID","TYPE_NAME","TYPEPROPERTY","DENSE_RANK","NTILE","RANK","ROW_NUMBER","PUBLISHINGSERVERNAME","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","CERTENCODED","CERTPRIVATEKEY","CURRENT_USER","HAS_DBACCESS","HAS_PERMS_BY_NAME","IS_MEMBER","IS_ROLEMEMBER","IS_SRVROLEMEMBER","LOGINPROPERTY","ORIGINAL_LOGIN","PERMISSIONS","PWDENCRYPT","PWDCOMPARE","SESSION_USER","SESSIONPROPERTY","SUSER_ID","SUSER_NAME","SUSER_SID","SUSER_SNAME","SYSTEM_USER","USER","USER_ID","USER_NAME","ASCII","CHAR","CHARINDEX","CONCAT","DIFFERENCE","FORMAT","LEFT","LEN","LOWER","LTRIM","NCHAR","PATINDEX","QUOTENAME","REPLACE","REPLICATE","REVERSE","RIGHT","RTRIM","SOUNDEX","SPACE","STR","STUFF","SUBSTRING","UNICODE","UPPER","BINARY_CHECKSUM","CHECKSUM","CONNECTIONPROPERTY","CONTEXT_INFO","CURRENT_REQUEST_ID","ERROR_LINE","ERROR_NUMBER","ERROR_MESSAGE","ERROR_PROCEDURE","ERROR_SEVERITY","ERROR_STATE","FORMATMESSAGE","GETANSINULL","GET_FILESTREAM_TRANSACTION_CONTEXT","HOST_ID","HOST_NAME","ISNULL","ISNUMERIC","MIN_ACTIVE_ROWVERSION","NEWID","NEWSEQUENTIALID","ROWCOUNT_BIG","XACT_STATE","TEXTPTR","TEXTVALID","COLUMNS_UPDATED","EVENTDATA","TRIGGER_NESTLEVEL","UPDATE","CHANGETABLE","CHANGE_TRACKING_CONTEXT","CHANGE_TRACKING_CURRENT_VERSION","CHANGE_TRACKING_IS_COLUMN_IN_MASK","CHANGE_TRACKING_MIN_VALID_VERSION","CONTAINSTABLE","FREETEXTTABLE","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","FILETABLEROOTPATH","GETFILENAMESPACEPATH","GETPATHLOCATOR","PATHNAME","GET_TRANSMISSION_STATUS"],builtinVariables:["@@DATEFIRST","@@DBTS","@@LANGID","@@LANGUAGE","@@LOCK_TIMEOUT","@@MAX_CONNECTIONS","@@MAX_PRECISION","@@NESTLEVEL","@@OPTIONS","@@REMSERVER","@@SERVERNAME","@@SERVICENAME","@@SPID","@@TEXTSIZE","@@VERSION","@@CURSOR_ROWS","@@FETCH_STATUS","@@DATEFIRST","@@PROCID","@@ERROR","@@IDENTITY","@@ROWCOUNT","@@TRANCOUNT","@@CONNECTIONS","@@CPU_BUSY","@@IDLE","@@IO_BUSY","@@PACKET_ERRORS","@@PACK_RECEIVED","@@PACK_SENT","@@TIMETICKS","@@TOTAL_ERRORS","@@TOTAL_READ","@@TOTAL_WRITE"],pseudoColumns:["$ACTION","$IDENTITY","$ROWGUID","$PARTITION"],tokenizer:{root:[{include:"@comments"},{include:"@whitespace"},{include:"@pseudoColumns"},{include:"@numbers"},{include:"@strings"},{include:"@complexIdentifiers"},{include:"@scopes"},[/(<)(where|set|foreach|if|trim|elseif|else)/,["delimiter",{token:"tag",next:"@xml"}]],[/[;,.]/,"delimiter"],[/[()]/,"@brackets"],[/[\w@#$]+/,{cases:{"@keywords":"keyword","@operators":"operator","@builtinVariables":"predefined","@builtinFunctions":"predefined","@default":"identifier"}}],[/[<>=!%&+\-*/|~^]/,"operator"]],whitespace:[[/\s+/,"white"]],comments:[[/--+.*/,"comment"],[/\/\*/,{token:"comment.quote",next:"@comment"}]],comment:[[/[^*/]+/,"comment"],[/\*\//,{token:"comment.quote",next:"@pop"}],[/./,"comment"]],pseudoColumns:[[/[$][A-Za-z_][\w@#$]*/,{cases:{"@pseudoColumns":"predefined","@default":"identifier"}}]],numbers:[[/0[xX][0-9a-fA-F]*/,"number"],[/[$][+-]*\d*(\.\d*)?/,"number"],[/((\d+(\.\d*)?)|(\.\d+))([eE][\-+]?\d+)?/,"number"]],strings:[[/N'/,{token:"string",next:"@string"}],[/'/,{token:"string",next:"@string"}]],string:[[/[^']+/,"string"],[/''/,"string"],[/'/,{token:"string",next:"@pop"}]],complexIdentifiers:[[/\[/,{token:"identifier.quote",next:"@bracketedIdentifier"}],[/"/,{token:"identifier.quote",next:"@quotedIdentifier"}]],bracketedIdentifier:[[/[^\]]+/,"identifier"],[/]]/,"identifier"],[/]/,{token:"identifier.quote",next:"@pop"}]],quotedIdentifier:[[/[^"]+/,"identifier"],[/""/,"identifier"],[/"/,{token:"identifier.quote",next:"@pop"}]],scopes:[[/BEGIN\s+(DISTRIBUTED\s+)?TRAN(SACTION)?\b/i,"keyword"],[/BEGIN\s+TRY\b/i,{token:"keyword.try"}],[/END\s+TRY\b/i,{token:"keyword.try"}],[/BEGIN\s+CATCH\b/i,{token:"keyword.catch"}],[/END\s+CATCH\b/i,{token:"keyword.catch"}],[/(BEGIN|CASE)\b/i,{token:"keyword.block"}],[/END\b/i,{token:"keyword.block"}],[/WHEN\b/i,{token:"keyword.choice"}],[/THEN\b/i,{token:"keyword.choice"}]],xml:[[/"([^"]*)"/,"attribute.value"],[/'([^']*)'/,"attribute.value"],[/[\w\-]+/,"attribute.name"],[/=/,"delimiter"],[/>/,{token:"delimiter",next:"@xmlEmbedded",nextEmbedded:"mybatis"}],[/[ \t\r\n]+/],[/(<\/)(where|if|set|foreach|trim|elseif|else)(>)/,["delimiter","tag",{token:"delimiter",next:"@pop"}]]],xmlEmbedded:[[/<\/(where|if|set|foreach|trim|elseif|else)/,{token:"tag",next:"@pop",nextEmbedded:"@pop"}],[/[^<]+/,""]]}})},ar=()=>{const r=new Map;ir();const e="magicscript";T.register({id:e,aliases:["MagicScript"],filenamePatterns:["*.magic","*.ms"]}),T.setLanguageConfiguration(e,{wordPattern:/(-?\d*\.\d\w*)|([^`~!#%^&*()\-=+[{\]}\\|;:'",.<>/?\s]+)/g,brackets:[["{","}"],["[","]"],["(",")"]],onEnterRules:[{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,afterText:/^\s*\*\/$/,action:{indentAction:T.IndentAction.IndentOutdent,appendText:" * "}},{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,action:{indentAction:T.IndentAction.None,appendText:" * "}},{beforeText:/^(\t|(\ \ ))*\ \*(\ ([^\*]|\*(?!\/))*)?$/,action:{indentAction:T.IndentAction.None,appendText:"* "}},{beforeText:/^(\t|(\ \ ))*\ \*\/\s*$/,action:{indentAction:T.IndentAction.None,removeText:1}}],comments:{lineComment:"//",blockComment:["/*","*/"]},operators:["<=",">=","==","!=","+","-","*","/","%","&","|","!","&&","||","?",":","++","--","+=","-=","*=","/="],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"""',close:'"""',notIn:["string.multi"]},{open:"<where>",close:"</where>"},{open:"<if",close:' test=""></if>'},{open:"<elseif",close:' test=""></elseif>'},{open:"<else",close:"></else>"},{open:"<set>",close:"</set>"},{open:"<trim>",close:"</trim>"},{open:"<foreach",close:' collection=""></foreach>'},{open:'"',close:'"',notIn:["string"]},{open:"'",close:"'",notIn:["string"]},{open:"/**",close:" */",notIn:["string"]}]}),T.setMonarchTokensProvider(e,re),T.registerCompletionItemProvider(e,Zt),T.registerFoldingRangeProvider(e,nr),T.registerSignatureHelpProvider(e,rr),T.registerHoverProvider(e,tr),T.registerReferenceProvider(e,er),T.registerDefinitionProvider(e,zt);const t=s=>{if(!s)return;const n=s.getValue();let a=[];try{const o=new W(new U(q(n)));o.parse(!1),v.setModelMarkers(s,"validate",[]),a=o.getErrors()}catch(o){o?.span&&a.push(ue.enhanceError(o.message,o.span))}const l=a.map(o=>({startLineNumber:o.span.getLine().lineNumber,endLineNumber:o.span.getLine().endLineNumber,startColumn:o.span.getLine().startCol,endColumn:o.span.getLine().endCol,message:o.message,severity:qe.Error}));v.setModelMarkers(s,"validate",l)};v.onDidCreateModel(s=>{if(s.getLanguageId()===e){t(s);const n=s.onDidChangeContent(a=>{t(s)});r.set(s,n)}}),v.onWillDisposeModel(s=>{s.getLanguageId()===e&&r.get(s).dispose()})};function lr(){ar()}function hr(r){r(fe).toSelf().inSingletonScope(),r(Ae).to(z).inSingletonScope(),r(Ae).to(ee).inSingletonScope(),r(Ke).to(te),lr()}export{hr as bindMonacoModule};
